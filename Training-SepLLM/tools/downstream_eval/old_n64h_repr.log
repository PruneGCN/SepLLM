2025-01-03:14:58:43,086 INFO     [utils.py:148] Note: NumExpr detected 32 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-01-03:14:58:43,975 INFO     [config.py:59] PyTorch version 2.1.0+cu121 available.
2025-01-03:14:58:49,425 INFO     [__main__.py:132] Verbosity set to INFO
2025-01-03:14:59:12,382 INFO     [__main__.py:205] Selected Tasks: ['arc_challenge', 'arc_easy', 'lambada_openai', 'logiqa', 'piqa', 'sciq', 'wikitext', 'winogrande', 'wsc']
2025-01-03:14:59:12,389 WARNING  [evaluator.py:93] generation_kwargs specified through cli, these settings will be used over set parameters in yaml tasks.
2025-01-03:14:59:13,605 INFO     [huggingface.py:120] Using device 'cuda:0'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2025-01-03:14:59:14,722 WARNING  [huggingface.py:284] WARNING: The number of total system GPUs does not match the number of spawned processes. If you would like to use data parallelism, please launch the script with 'accelerate launch *script*'. Current run will proceed with 1 devices.
2025-01-03:14:59:25,177 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:14:59:25,177 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:14:59:35,868 WARNING  [task.py:614] [Task: wikitext] metric word_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:14:59:35,868 WARNING  [task.py:626] [Task: wikitext] metric word_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:14:59:35,868 WARNING  [task.py:614] [Task: wikitext] metric byte_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:14:59:35,868 WARNING  [task.py:626] [Task: wikitext] metric byte_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:14:59:35,868 WARNING  [task.py:614] [Task: wikitext] metric bits_per_byte is defined, but aggregation is not. using default aggregation=bits_per_byte
2025-01-03:14:59:35,868 WARNING  [task.py:626] [Task: wikitext] metric bits_per_byte is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:14:59:41,922 WARNING  [task.py:614] [Task: wsc] metric acc is defined, but aggregation is not. using default aggregation=mean
2025-01-03:14:59:41,922 WARNING  [task.py:626] [Task: wsc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_challenge from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_easy from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of lambada_openai from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of logiqa from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of piqa from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of sciq from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wikitext from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of winogrande from None to 5
2025-01-03:14:59:44,262 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wsc from None to 5
2025-01-03:14:59:44,262 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:14:59:56,448 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:00:18,304 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:00,157 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:01,046 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:08,539 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:14,631 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:15,204 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:15,286 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:01:15,299 INFO     [evaluator.py:319] Running loglikelihood requests
###########################k and window_size, etc.############################################
prefill_k: 0
decode_k: 0
self.prefill_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.decode_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.Layer_num: 12
self.att_sink_max_idx: 2
self.original_flag:  False
self.streamingLLM:  False
self.random_special_tokens_uniform:  False
self.random_special_tokens_general:  False
self.NOT_AVOID_SEP:  False
self.EXCLUDE_DIAGONAL:  True
>>> Please be careful of the special_tokens_id, Make sure they are correct for the current LLM
self.special_tokens_id: [15, 13, 32, 2, 28, 27, 209, 186, 187]
self.floating_window: True
This is about NOT streamingLLM since self.decode_k =0, self.prefill_k = 0 and self.streamingLLM: False
>>>>>>>>---------##########################################################-----------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>------------------ Running our version of the mask strategy-------------------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>---------##########################################################-----------<<<<<<<<
#################in loglikelihood#####################
#################in _loglikelihood_tokens#####################
  0%|          | 0/32363 [00:00<?, ?it/s]  0%|          | 1/32363 [00:08<78:10:00,  8.70s/it]  0%|          | 65/32363 [00:09<57:23,  9.38it/s]    0%|          | 129/32363 [00:10<27:22, 19.62it/s]  1%|          | 193/32363 [00:10<17:26, 30.75it/s]  1%|          | 257/32363 [00:11<12:40, 42.24it/s]  1%|          | 321/32363 [00:12<10:02, 53.21it/s]  1%|          | 385/32363 [00:12<08:20, 63.86it/s]  1%|▏         | 449/32363 [00:13<07:16, 73.19it/s]  2%|▏         | 513/32363 [00:14<06:29, 81.68it/s]  2%|▏         | 577/32363 [00:14<05:57, 88.94it/s]  2%|▏         | 641/32363 [00:15<05:32, 95.33it/s]  2%|▏         | 705/32363 [00:15<05:12, 101.35it/s]  2%|▏         | 769/32363 [00:16<04:59, 105.48it/s]  3%|▎         | 833/32363 [00:16<04:52, 107.86it/s]  3%|▎         | 897/32363 [00:17<04:45, 110.19it/s]  3%|▎         | 961/32363 [00:17<04:39, 112.27it/s]  3%|▎         | 1025/32363 [00:18<04:34, 114.34it/s]  3%|▎         | 1089/32363 [00:18<04:25, 117.72it/s]  4%|▎         | 1153/32363 [00:19<04:22, 118.94it/s]  4%|▍         | 1217/32363 [00:20<04:19, 120.00it/s]  4%|▍         | 1281/32363 [00:20<04:16, 121.22it/s]  4%|▍         | 1345/32363 [00:21<04:10, 123.79it/s]  4%|▍         | 1409/32363 [00:21<04:05, 126.06it/s]  5%|▍         | 1473/32363 [00:21<04:01, 128.07it/s]  5%|▍         | 1537/32363 [00:22<03:57, 129.92it/s]  5%|▍         | 1601/32363 [00:22<03:54, 131.42it/s]  5%|▌         | 1665/32363 [00:23<03:53, 131.31it/s]  5%|▌         | 1729/32363 [00:23<03:52, 131.64it/s]  6%|▌         | 1793/32363 [00:24<03:51, 132.26it/s]  6%|▌         | 1857/32363 [00:24<03:45, 135.33it/s]  6%|▌         | 1921/32363 [00:25<03:44, 135.66it/s]  6%|▌         | 1985/32363 [00:25<03:42, 136.31it/s]  6%|▋         | 2049/32363 [00:26<03:40, 137.17it/s]  7%|▋         | 2113/32363 [00:26<03:34, 141.26it/s]  7%|▋         | 2177/32363 [00:27<03:29, 144.05it/s]  7%|▋         | 2241/32363 [00:27<03:27, 145.34it/s]  7%|▋         | 2305/32363 [00:27<03:24, 147.02it/s]  7%|▋         | 2369/32363 [00:28<03:21, 148.58it/s]  8%|▊         | 2433/32363 [00:28<03:19, 150.28it/s]  8%|▊         | 2497/32363 [00:29<03:15, 152.44it/s]  8%|▊         | 2561/32363 [00:29<03:12, 154.61it/s]  8%|▊         | 2625/32363 [00:29<03:04, 161.11it/s]  8%|▊         | 2689/32363 [00:30<03:02, 163.03it/s]  9%|▊         | 2753/32363 [00:30<02:56, 168.12it/s]  9%|▊         | 2817/32363 [00:30<02:48, 175.36it/s]  9%|▉         | 2881/32363 [00:31<02:42, 181.96it/s]  9%|▉         | 2945/32363 [00:31<02:37, 186.27it/s]  9%|▉         | 3009/32363 [00:31<02:32, 192.18it/s]  9%|▉         | 3073/32363 [00:32<02:27, 198.51it/s] 10%|▉         | 3137/32363 [00:32<02:24, 202.59it/s] 10%|▉         | 3201/32363 [00:32<02:20, 207.50it/s] 10%|█         | 3265/32363 [00:33<02:15, 214.64it/s] 10%|█         | 3329/32363 [00:33<02:09, 223.85it/s] 10%|█         | 3393/32363 [00:33<02:04, 232.42it/s] 11%|█         | 3457/32363 [00:33<02:01, 238.54it/s] 11%|█         | 3521/32363 [00:34<01:56, 246.85it/s] 11%|█         | 3585/32363 [00:34<01:52, 256.03it/s] 11%|█▏        | 3649/32363 [00:34<01:49, 261.68it/s] 11%|█▏        | 3713/32363 [00:34<01:46, 270.01it/s] 12%|█▏        | 3777/32363 [00:34<01:41, 282.93it/s] 12%|█▏        | 3841/32363 [00:35<01:38, 290.61it/s] 12%|█▏        | 3905/32363 [00:35<01:35, 297.36it/s] 12%|█▏        | 3969/32363 [00:35<01:32, 307.50it/s] 12%|█▏        | 4033/32363 [00:35<01:29, 314.88it/s] 13%|█▎        | 4097/32363 [00:35<01:26, 325.19it/s] 13%|█▎        | 4161/32363 [00:36<01:24, 332.51it/s] 13%|█▎        | 4225/32363 [00:36<01:22, 340.02it/s] 13%|█▎        | 4289/32363 [00:36<01:20, 347.39it/s] 13%|█▎        | 4353/32363 [00:36<01:18, 354.90it/s] 14%|█▎        | 4417/32363 [00:36<01:16, 366.87it/s] 14%|█▍        | 4481/32363 [00:36<01:13, 377.18it/s] 14%|█▍        | 4545/32363 [00:37<01:12, 386.26it/s] 14%|█▍        | 4609/32363 [00:37<01:10, 394.59it/s] 14%|█▍        | 4673/32363 [00:37<01:08, 403.56it/s] 15%|█▍        | 4737/32363 [00:37<01:06, 412.34it/s] 15%|█▍        | 4801/32363 [00:37<01:05, 421.06it/s] 15%|█▌        | 4865/32363 [00:37<01:04, 428.87it/s] 15%|█▌        | 4929/32363 [00:38<01:02, 440.72it/s] 15%|█▌        | 4993/32363 [00:38<01:00, 451.14it/s] 16%|█▌        | 5057/32363 [00:38<00:59, 459.84it/s] 16%|█▌        | 5121/32363 [00:38<00:58, 466.48it/s] 16%|█▌        | 5185/32363 [00:38<00:57, 475.49it/s] 16%|█▌        | 5249/32363 [00:38<00:56, 480.93it/s] 16%|█▋        | 5313/32363 [00:38<00:55, 488.89it/s] 17%|█▋        | 5377/32363 [00:38<00:54, 492.85it/s] 17%|█▋        | 5441/32363 [00:39<00:54, 496.03it/s] 17%|█▋        | 5505/32363 [00:39<00:53, 500.01it/s] 17%|█▋        | 5569/32363 [00:39<00:53, 503.40it/s] 17%|█▋        | 5633/32363 [00:39<00:52, 506.93it/s] 18%|█▊        | 5697/32363 [00:39<00:52, 510.41it/s] 18%|█▊        | 5761/32363 [00:39<00:51, 513.35it/s] 18%|█▊        | 5825/32363 [00:39<00:51, 519.11it/s] 18%|█▊        | 5889/32363 [00:39<00:50, 524.02it/s] 18%|█▊        | 5953/32363 [00:40<00:49, 529.90it/s]Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 64
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (126026, 411648), ratio: 0.3061499144917353 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (18757276, 77479680), ratio: 0.24209284292347047 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (43365650, 110527488.0), ratio: 0.39235171978214695 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (12480810731, 45262176768.0), ratio: 0.27574481879147794 
 19%|█▊        | 6017/32363 [00:40<00:49, 529.05it/s] 19%|█▉        | 6081/32363 [00:40<00:49, 529.57it/s] 19%|█▉        | 6145/32363 [00:40<00:49, 533.58it/s] 19%|█▉        | 6209/32363 [00:40<00:48, 537.55it/s] 19%|█▉        | 6273/32363 [00:40<00:48, 537.00it/s] 20%|█▉        | 6337/32363 [00:40<00:47, 543.44it/s] 20%|█▉        | 6401/32363 [00:40<00:47, 542.19it/s] 20%|█▉        | 6465/32363 [00:40<00:47, 545.17it/s] 20%|██        | 6529/32363 [00:41<00:47, 544.30it/s] 20%|██        | 6593/32363 [00:41<00:47, 547.86it/s] 21%|██        | 6657/32363 [00:41<00:46, 551.12it/s] 21%|██        | 6721/32363 [00:41<00:46, 550.29it/s] 21%|██        | 6785/32363 [00:41<00:46, 555.59it/s] 21%|██        | 6849/32363 [00:41<00:46, 554.29it/s] 21%|██▏       | 6913/32363 [00:41<00:45, 557.39it/s] 22%|██▏       | 6977/32363 [00:41<00:45, 556.69it/s] 22%|██▏       | 7041/32363 [00:42<00:45, 560.47it/s] 22%|██▏       | 7105/32363 [00:42<00:45, 559.91it/s] 22%|██▏       | 7169/32363 [00:42<00:44, 563.36it/s] 22%|██▏       | 7233/32363 [00:42<00:44, 562.74it/s] 23%|██▎       | 7297/32363 [00:42<00:44, 561.19it/s] 23%|██▎       | 7361/32363 [00:42<00:43, 572.03it/s] 23%|██▎       | 7425/32363 [00:42<00:43, 573.92it/s] 23%|██▎       | 7489/32363 [00:42<00:42, 579.57it/s] 23%|██▎       | 7553/32363 [00:42<00:42, 580.14it/s] 24%|██▎       | 7617/32363 [00:43<00:42, 584.93it/s] 24%|██▎       | 7681/32363 [00:43<00:42, 584.76it/s] 24%|██▍       | 7745/32363 [00:43<00:41, 589.27it/s] 24%|██▍       | 7809/32363 [00:43<00:41, 588.67it/s] 24%|██▍       | 7873/32363 [00:43<00:41, 593.43it/s] 25%|██▍       | 7937/32363 [00:43<00:41, 592.55it/s] 25%|██▍       | 8001/32363 [00:43<00:40, 597.13it/s] 25%|██▍       | 8065/32363 [00:43<00:40, 596.99it/s] 25%|██▌       | 8129/32363 [00:43<00:40, 596.22it/s] 25%|██▌       | 8193/32363 [00:43<00:40, 600.56it/s] 26%|██▌       | 8257/32363 [00:44<00:40, 599.80it/s] 26%|██▌       | 8321/32363 [00:44<00:40, 598.54it/s] 26%|██▌       | 8385/32363 [00:44<00:39, 602.27it/s] 26%|██▌       | 8449/32363 [00:44<00:39, 600.95it/s] 26%|██▋       | 8513/32363 [00:44<00:39, 607.09it/s] 27%|██▋       | 8577/32363 [00:44<00:39, 605.98it/s] 27%|██▋       | 8641/32363 [00:44<00:39, 604.45it/s] 27%|██▋       | 8705/32363 [00:44<00:38, 608.84it/s] 27%|██▋       | 8769/32363 [00:44<00:38, 608.57it/s] 27%|██▋       | 8833/32363 [00:45<00:38, 613.23it/s] 27%|██▋       | 8897/32363 [00:45<00:38, 616.13it/s] 28%|██▊       | 8961/32363 [00:45<00:38, 614.07it/s] 28%|██▊       | 9025/32363 [00:45<00:37, 617.95it/s] 28%|██▊       | 9089/32363 [00:45<00:37, 616.48it/s] 28%|██▊       | 9153/32363 [00:45<00:37, 614.48it/s] 28%|██▊       | 9217/32363 [00:45<00:37, 619.03it/s] 29%|██▊       | 9281/32363 [00:45<00:37, 617.98it/s] 29%|██▉       | 9345/32363 [00:45<00:36, 623.21it/s] 29%|██▉       | 9409/32363 [00:45<00:36, 625.59it/s] 29%|██▉       | 9473/32363 [00:46<00:36, 623.22it/s] 29%|██▉       | 9537/32363 [00:46<00:36, 627.75it/s] 30%|██▉       | 9601/32363 [00:46<00:36, 626.46it/s] 30%|██▉       | 9667/32363 [00:46<00:35, 636.28it/s] 30%|███       | 9731/32363 [00:46<00:35, 633.52it/s] 30%|███       | 9823/32363 [00:46<00:31, 718.29it/s] 31%|███       | 9895/32363 [00:46<00:31, 715.29it/s] 31%|███       | 9980/32363 [00:46<00:29, 755.19it/s] 31%|███       | 10056/32363 [00:46<00:37, 590.33it/s] 31%|███▏      | 10121/32363 [00:47<00:36, 604.63it/s] 32%|███▏      | 10214/32363 [00:47<00:32, 689.94it/s] 32%|███▏      | 10305/32363 [00:47<00:36, 598.30it/s] 32%|███▏      | 10389/32363 [00:47<00:33, 655.59it/s] 32%|███▏      | 10497/32363 [00:47<00:35, 617.77it/s] 33%|███▎      | 10587/32363 [00:47<00:31, 681.64it/s] 33%|███▎      | 10689/32363 [00:47<00:34, 627.11it/s] 33%|███▎      | 10817/32363 [00:48<00:33, 646.81it/s] 34%|███▍      | 10945/32363 [00:48<00:32, 659.00it/s] 34%|███▍      | 11073/32363 [00:48<00:31, 674.63it/s] 35%|███▍      | 11201/32363 [00:48<00:30, 695.15it/s] 35%|███▌      | 11329/32363 [00:48<00:29, 715.78it/s] 35%|███▌      | 11457/32363 [00:48<00:28, 739.22it/s] 36%|███▌      | 11585/32363 [00:49<00:26, 770.43it/s] 36%|███▌      | 11713/32363 [00:49<00:25, 811.13it/s] 37%|███▋      | 11841/32363 [00:49<00:24, 849.59it/s] 37%|███▋      | 11969/32363 [00:49<00:22, 889.32it/s] 37%|███▋      | 12097/32363 [00:49<00:21, 929.18it/s] 38%|███▊      | 12225/32363 [00:49<00:20, 967.77it/s] 38%|███▊      | 12353/32363 [00:49<00:19, 1016.00it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (96191, 242688), ratio: 0.39635663897928053 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (30425539, 113603328), ratio: 0.26782260287304904 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (20239182, 38466048.0), ratio: 0.5261570411392528 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16076848271, 53897813760.0), ratio: 0.29828386625454106 
 39%|███▊      | 12481/32363 [00:50<00:18, 1054.27it/s] 39%|███▉      | 12609/32363 [00:50<00:18, 1087.06it/s] 39%|███▉      | 12737/32363 [00:50<00:17, 1120.95it/s] 40%|███▉      | 12865/32363 [00:50<00:16, 1153.62it/s] 40%|████      | 12993/32363 [00:50<00:16, 1176.73it/s] 41%|████      | 13121/32363 [00:50<00:15, 1204.21it/s] 41%|████      | 13262/32363 [00:50<00:15, 1263.24it/s] 42%|████▏     | 13431/32363 [00:50<00:13, 1387.27it/s] 42%|████▏     | 13571/32363 [00:50<00:15, 1236.94it/s] 42%|████▏     | 13752/32363 [00:50<00:13, 1392.55it/s] 43%|████▎     | 13896/32363 [00:51<00:14, 1277.57it/s] 44%|████▎     | 14081/32363 [00:51<00:14, 1296.58it/s] 44%|████▍     | 14273/32363 [00:51<00:13, 1330.68it/s] 45%|████▍     | 14465/32363 [00:51<00:13, 1358.03it/s] 45%|████▌     | 14657/32363 [00:51<00:12, 1379.17it/s] 46%|████▌     | 14849/32363 [00:51<00:12, 1415.67it/s] 46%|████▋     | 15041/32363 [00:51<00:11, 1446.47it/s] 47%|████▋     | 15233/32363 [00:52<00:11, 1471.01it/s] 48%|████▊     | 15425/32363 [00:52<00:11, 1489.78it/s] 48%|████▊     | 15617/32363 [00:52<00:11, 1511.33it/s] 49%|████▉     | 15809/32363 [00:52<00:10, 1529.05it/s] 49%|████▉     | 16001/32363 [00:52<00:10, 1545.14it/s] 50%|█████     | 16193/32363 [00:52<00:10, 1561.67it/s] 51%|█████     | 16385/32363 [00:52<00:10, 1577.56it/s] 51%|█████     | 16577/32363 [00:52<00:09, 1593.66it/s] 52%|█████▏    | 16769/32363 [00:52<00:09, 1605.39it/s] 52%|█████▏    | 16961/32363 [00:53<00:09, 1620.51it/s] 53%|█████▎    | 17153/32363 [00:53<00:09, 1630.92it/s] 54%|█████▎    | 17345/32363 [00:53<00:09, 1638.13it/s] 54%|█████▍    | 17537/32363 [00:53<00:08, 1652.38it/s] 55%|█████▍    | 17729/32363 [00:53<00:08, 1659.81it/s] 55%|█████▌    | 17921/32363 [00:53<00:08, 1674.68it/s] 56%|█████▌    | 18113/32363 [00:53<00:08, 1693.51it/s] 57%|█████▋    | 18305/32363 [00:53<00:08, 1705.37it/s] 57%|█████▋    | 18497/32363 [00:54<00:08, 1711.95it/s] 58%|█████▊    | 18689/32363 [00:54<00:07, 1720.49it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (80400, 168192), ratio: 0.4780251141583545 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (38987261, 132879360), ratio: 0.2934034375240873 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (11754907, 18501120.0), ratio: 0.6353619132247327 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17517248938, 56350587648.0), ratio: 0.3108618679795032 
 58%|█████▊    | 18881/32363 [00:54<00:07, 1729.04it/s] 59%|█████▉    | 19073/32363 [00:54<00:07, 1738.98it/s] 60%|█████▉    | 19265/32363 [00:54<00:07, 1751.91it/s] 60%|██████    | 19457/32363 [00:54<00:07, 1762.52it/s] 61%|██████    | 19649/32363 [00:54<00:07, 1766.97it/s] 61%|██████▏   | 19841/32363 [00:54<00:07, 1781.75it/s] 62%|██████▏   | 20033/32363 [00:54<00:06, 1788.88it/s] 62%|██████▏   | 20225/32363 [00:54<00:06, 1798.24it/s] 63%|██████▎   | 20417/32363 [00:55<00:06, 1804.65it/s] 64%|██████▎   | 20609/32363 [00:55<00:06, 1815.10it/s] 64%|██████▍   | 20801/32363 [00:55<00:06, 1824.67it/s] 65%|██████▍   | 20993/32363 [00:55<00:06, 1830.51it/s] 65%|██████▌   | 21185/32363 [00:55<00:06, 1847.96it/s] 66%|██████▌   | 21377/32363 [00:55<00:05, 1851.69it/s] 67%|██████▋   | 21569/32363 [00:55<00:05, 1864.54it/s] 67%|██████▋   | 21761/32363 [00:55<00:05, 1873.16it/s] 68%|██████▊   | 21953/32363 [00:55<00:05, 1884.72it/s] 68%|██████▊   | 22145/32363 [00:56<00:05, 1889.68it/s] 69%|██████▉   | 22337/32363 [00:56<00:05, 1897.10it/s] 70%|██████▉   | 22540/32363 [00:56<00:05, 1936.33it/s] 70%|███████   | 22739/32363 [00:56<00:04, 1952.01it/s] 71%|███████   | 22950/32363 [00:56<00:04, 1998.90it/s] 72%|███████▏  | 23156/32363 [00:56<00:04, 2017.02it/s] 72%|███████▏  | 23361/32363 [00:56<00:04, 1895.11it/s] 73%|███████▎  | 23617/32363 [00:56<00:04, 1942.56it/s] 74%|███████▍  | 23873/32363 [00:56<00:04, 1973.74it/s] 75%|███████▍  | 24129/32363 [00:57<00:04, 2002.28it/s] 75%|███████▌  | 24385/32363 [00:57<00:03, 2023.42it/s] 76%|███████▌  | 24641/32363 [00:57<00:03, 2044.40it/s] 77%|███████▋  | 24897/32363 [00:57<00:03, 2059.92it/s] 78%|███████▊  | 25153/32363 [00:57<00:03, 2078.93it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (75945, 139008), ratio: 0.5463354627104459 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (46814879, 148181760), ratio: 0.3159287553339944 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (8991348, 12649728.0), ratio: 0.7107937814947712 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (18548074267, 57887092224.0), ratio: 0.32041813734962427 
 79%|███████▊  | 25409/32363 [00:57<00:03, 2094.68it/s] 79%|███████▉  | 25665/32363 [00:57<00:03, 2110.72it/s] 80%|████████  | 25921/32363 [00:57<00:03, 2126.61it/s] 81%|████████  | 26177/32363 [00:57<00:02, 2154.18it/s] 82%|████████▏ | 26433/32363 [00:58<00:02, 2172.03it/s] 82%|████████▏ | 26689/32363 [00:58<00:02, 2188.63it/s] 83%|████████▎ | 26945/32363 [00:58<00:02, 2209.11it/s] 84%|████████▍ | 27201/32363 [00:58<00:02, 2231.40it/s] 85%|████████▍ | 27457/32363 [00:58<00:02, 2249.14it/s] 86%|████████▌ | 27713/32363 [00:58<00:02, 2268.80it/s] 86%|████████▋ | 27969/32363 [00:58<00:01, 2285.38it/s] 87%|████████▋ | 28225/32363 [00:58<00:01, 2314.95it/s] 88%|████████▊ | 28481/32363 [00:58<00:01, 2346.64it/s] 89%|████████▉ | 28737/32363 [00:59<00:01, 2370.06it/s] 90%|████████▉ | 28993/32363 [00:59<00:01, 2402.11it/s] 90%|█████████ | 29249/32363 [00:59<00:01, 2438.62it/s] 91%|█████████ | 29510/32363 [00:59<00:01, 2487.98it/s] 92%|█████████▏| 29761/32363 [00:59<00:01, 2478.49it/s] 93%|█████████▎| 30209/32363 [00:59<00:00, 2996.74it/s] 95%|█████████▍| 30712/32363 [00:59<00:00, 3587.65it/s] 96%|█████████▋| 31169/32363 [00:59<00:00, 3861.64it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (14592, 14592), ratio: 1.0 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (52512364, 157763328), ratio: 0.3328553261756792 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (145920, 145920.0), ratio: 1.0 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (19110917529, 58642272000.0), ratio: 0.3258897869611873 
 98%|█████████▊| 31681/32363 [00:59<00:00, 4183.24it/s] 99%|█████████▉| 32193/32363 [01:00<00:00, 4388.57it/s]100%|██████████| 32363/32363 [01:00<00:00, 539.09it/s] 
2025-01-03:15:02:52,070 INFO     [evaluator.py:319] Running loglikelihood_rolling requests

#################in loglikelihood_rolling#####################
Passed argument batch_size = auto. Detecting largest batch size
Determined Largest batch size: 64
  0%|          | 0/62 [00:00<?, ?it/s]  3%|▎         | 2/62 [00:00<00:03, 18.64it/s]  6%|▋         | 4/62 [00:00<00:03, 14.96it/s] 11%|█▏        | 7/62 [00:00<00:04, 13.47it/s] 15%|█▍        | 9/62 [00:00<00:04, 11.59it/s] 19%|█▉        | 12/62 [00:00<00:03, 12.70it/s] 27%|██▋       | 17/62 [00:01<00:02, 17.24it/s] 32%|███▏      | 20/62 [00:01<00:02, 18.02it/s] 37%|███▋      | 23/62 [00:01<00:02, 18.45it/s] 40%|████      | 25/62 [00:01<00:02, 15.51it/s] 44%|████▎     | 27/62 [00:01<00:02, 13.06it/s] 50%|█████     | 31/62 [00:01<00:01, 17.25it/s] 53%|█████▎    | 33/62 [00:02<00:01, 17.40it/s] 56%|█████▋    | 35/62 [00:02<00:01, 16.53it/s] 60%|█████▉    | 37/62 [00:02<00:01, 16.76it/s] 63%|██████▎   | 39/62 [00:02<00:01, 12.91it/s] 66%|██████▌   | 41/62 [00:02<00:01, 10.67it/s] 71%|███████   | 44/62 [00:02<00:01, 13.34it/s] 77%|███████▋  | 48/62 [00:03<00:00, 16.37it/s] 84%|████████▍ | 52/62 [00:03<00:00, 19.75it/s] 92%|█████████▏| 57/62 [00:03<00:00, 23.99it/s] 97%|█████████▋| 60/62 [00:03<00:00, 23.09it/s]100%|██████████| 62/62 [00:03<00:00, 16.82it/s]#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################

bootstrapping for stddev: perplexity
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:55,  1.80it/s] 33%|███▎      | 33/100 [00:00<00:01, 48.50it/s] 40%|████      | 40/100 [00:01<00:01, 40.68it/s] 65%|██████▌   | 65/100 [00:01<00:00, 68.40it/s] 75%|███████▌  | 75/100 [00:01<00:00, 60.55it/s] 83%|████████▎ | 83/100 [00:01<00:00, 58.84it/s] 98%|█████████▊| 98/100 [00:01<00:00, 68.34it/s]100%|██████████| 100/100 [00:01<00:00, 55.18it/s]fatal: not a git repository (or any parent up to mount point /lustre)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).

hf (pretrained=/lustre/fast/fast/txiao/shihan/saves/gpt-neox-new_seg/pythia160m-deduped/scaled_masked_softmax_fusion/checkpoints_w64_h2048/hf_checkpoints/global_step143000), gen_kwargs: (), limit: None, num_fewshot: 5, batch_size: auto (64)
|    Tasks     |Version|Filter|n-shot|    Metric     | Value |   |Stderr|
|--------------|-------|------|-----:|---------------|------:|---|-----:|
|arc_challenge |Yaml   |none  |     5|acc            | 0.2056|±  |0.0118|
|              |       |none  |     5|acc_norm       | 0.2440|±  |0.0126|
|arc_easy      |Yaml   |none  |     5|acc            | 0.4827|±  |0.0103|
|              |       |none  |     5|acc_norm       | 0.4499|±  |0.0102|
|lambada_openai|Yaml   |none  |     5|perplexity     |37.3862|±  |1.2870|
|              |       |none  |     5|acc            | 0.3035|±  |0.0064|
|logiqa        |Yaml   |none  |     5|acc            | 0.2611|±  |0.0172|
|              |       |none  |     5|acc_norm       | 0.2765|±  |0.0175|
|piqa          |Yaml   |none  |     5|acc            | 0.6322|±  |0.0113|
|              |       |none  |     5|acc_norm       | 0.6311|±  |0.0113|
|sciq          |Yaml   |none  |     5|acc            | 0.7910|±  |0.0129|
|              |       |none  |     5|acc_norm       | 0.7720|±  |0.0133|
|wikitext      |Yaml   |none  |     5|word_perplexity|30.4669|   |      |
|              |       |none  |     5|byte_perplexity| 1.8945|   |      |
|              |       |none  |     5|bits_per_byte  | 0.9218|   |      |
|winogrande    |Yaml   |none  |     5|acc            | 0.5162|±  |0.0140|
|wsc           |Yaml   |none  |     5|acc            | 0.3558|±  |0.0472|

