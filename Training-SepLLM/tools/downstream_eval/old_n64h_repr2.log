2025-01-03:15:23:19,692 INFO     [utils.py:148] Note: NumExpr detected 32 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-01-03:15:23:20,544 INFO     [config.py:59] PyTorch version 2.1.0+cu121 available.
2025-01-03:15:23:25,566 INFO     [__main__.py:132] Verbosity set to INFO
2025-01-03:15:23:45,645 INFO     [__main__.py:205] Selected Tasks: ['arc_challenge', 'arc_easy', 'lambada_openai', 'logiqa', 'piqa', 'sciq', 'wikitext', 'winogrande', 'wsc']
2025-01-03:15:23:45,650 WARNING  [evaluator.py:93] generation_kwargs specified through cli, these settings will be used over set parameters in yaml tasks.
2025-01-03:15:23:46,895 INFO     [huggingface.py:120] Using device 'cuda:0'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2025-01-03:15:23:47,632 WARNING  [huggingface.py:284] WARNING: The number of total system GPUs does not match the number of spawned processes. If you would like to use data parallelism, please launch the script with 'accelerate launch *script*'. Current run will proceed with 1 devices.
2025-01-03:15:23:57,813 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:15:23:57,813 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:15:24:09,216 WARNING  [task.py:614] [Task: wikitext] metric word_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:15:24:09,217 WARNING  [task.py:626] [Task: wikitext] metric word_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:24:09,217 WARNING  [task.py:614] [Task: wikitext] metric byte_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:15:24:09,217 WARNING  [task.py:626] [Task: wikitext] metric byte_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:24:09,217 WARNING  [task.py:614] [Task: wikitext] metric bits_per_byte is defined, but aggregation is not. using default aggregation=bits_per_byte
2025-01-03:15:24:09,217 WARNING  [task.py:626] [Task: wikitext] metric bits_per_byte is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:24:15,587 WARNING  [task.py:614] [Task: wsc] metric acc is defined, but aggregation is not. using default aggregation=mean
2025-01-03:15:24:15,587 WARNING  [task.py:626] [Task: wsc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_challenge from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_easy from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of lambada_openai from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of logiqa from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of piqa from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of sciq from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wikitext from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of winogrande from None to 5
2025-01-03:15:24:18,082 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wsc from None to 5
2025-01-03:15:24:18,082 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:24:31,500 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:24:54,049 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:39,787 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:40,800 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:48,974 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:55,736 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:56,434 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:56,530 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:25:56,547 INFO     [evaluator.py:319] Running loglikelihood requests
###########################k and window_size, etc.############################################
prefill_k: 0
decode_k: 0
self.prefill_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.decode_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.Layer_num: 12
self.att_sink_max_idx: 2
self.original_flag:  False
self.streamingLLM:  False
self.random_special_tokens_uniform:  False
self.random_special_tokens_general:  False
self.NOT_AVOID_SEP:  False
self.EXCLUDE_DIAGONAL:  True
>>> Please be careful of the special_tokens_id, Make sure they are correct for the current LLM
self.special_tokens_id: [15, 13, 32, 2, 28, 27, 209, 186, 187]
self.floating_window: True
This is about NOT streamingLLM since self.decode_k =0, self.prefill_k = 0 and self.streamingLLM: False
>>>>>>>>---------##########################################################-----------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>------------------ Running our version of the mask strategy-------------------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>---------##########################################################-----------<<<<<<<<
#################in loglikelihood#####################
#################in _loglikelihood_tokens#####################
  0%|          | 0/32363 [00:00<?, ?it/s]  0%|          | 1/32363 [00:08<79:46:27,  8.87s/it]  0%|          | 65/32363 [00:09<58:26,  9.21it/s]    0%|          | 129/32363 [00:10<27:48, 19.32it/s]  1%|          | 193/32363 [00:11<17:40, 30.33it/s]  1%|          | 257/32363 [00:11<12:49, 41.71it/s]  1%|          | 321/32363 [00:12<10:09, 52.59it/s]  1%|          | 385/32363 [00:13<08:26, 63.15it/s]  1%|▏         | 449/32363 [00:13<07:20, 72.44it/s]  2%|▏         | 513/32363 [00:14<06:33, 80.87it/s]  2%|▏         | 577/32363 [00:14<06:01, 88.03it/s]  2%|▏         | 641/32363 [00:15<05:36, 94.32it/s]  2%|▏         | 705/32363 [00:15<05:15, 100.19it/s]  2%|▏         | 769/32363 [00:16<05:02, 104.29it/s]  3%|▎         | 833/32363 [00:17<04:55, 106.61it/s]  3%|▎         | 897/32363 [00:17<04:48, 109.22it/s]  3%|▎         | 961/32363 [00:18<04:41, 111.47it/s]  3%|▎         | 1025/32363 [00:18<04:35, 113.66it/s]  3%|▎         | 1089/32363 [00:19<04:27, 117.09it/s]  4%|▎         | 1153/32363 [00:19<04:23, 118.31it/s]  4%|▍         | 1217/32363 [00:20<04:20, 119.51it/s]  4%|▍         | 1281/32363 [00:20<04:17, 120.87it/s]  4%|▍         | 1345/32363 [00:21<04:11, 123.45it/s]  4%|▍         | 1409/32363 [00:21<04:06, 125.63it/s]  5%|▍         | 1473/32363 [00:22<04:02, 127.64it/s]  5%|▍         | 1537/32363 [00:22<03:58, 129.47it/s]  5%|▍         | 1601/32363 [00:23<03:54, 130.97it/s]  5%|▌         | 1665/32363 [00:23<03:54, 130.81it/s]  5%|▌         | 1729/32363 [00:24<03:53, 131.11it/s]  6%|▌         | 1793/32363 [00:24<03:52, 131.65it/s]  6%|▌         | 1857/32363 [00:25<03:46, 134.74it/s]  6%|▌         | 1921/32363 [00:25<03:45, 135.15it/s]  6%|▌         | 1985/32363 [00:26<03:43, 135.81it/s]  6%|▋         | 2049/32363 [00:26<03:41, 136.81it/s]  7%|▋         | 2113/32363 [00:26<03:34, 140.93it/s]  7%|▋         | 2177/32363 [00:27<03:29, 143.81it/s]  7%|▋         | 2241/32363 [00:27<03:27, 145.09it/s]  7%|▋         | 2305/32363 [00:28<03:24, 146.77it/s]  7%|▋         | 2369/32363 [00:28<03:22, 148.33it/s]  8%|▊         | 2433/32363 [00:29<03:19, 149.92it/s]  8%|▊         | 2497/32363 [00:29<03:16, 152.08it/s]  8%|▊         | 2561/32363 [00:29<03:13, 154.13it/s]  8%|▊         | 2625/32363 [00:30<03:05, 160.52it/s]  8%|▊         | 2689/32363 [00:30<03:02, 162.44it/s]  9%|▊         | 2753/32363 [00:30<02:56, 167.46it/s]  9%|▊         | 2817/32363 [00:31<02:49, 174.62it/s]  9%|▉         | 2881/32363 [00:31<02:42, 181.22it/s]  9%|▉         | 2945/32363 [00:31<02:38, 185.46it/s]  9%|▉         | 3009/32363 [00:32<02:33, 191.36it/s]  9%|▉         | 3073/32363 [00:32<02:28, 197.65it/s] 10%|▉         | 3137/32363 [00:32<02:24, 201.68it/s] 10%|▉         | 3201/32363 [00:33<02:21, 206.55it/s] 10%|█         | 3265/32363 [00:33<02:16, 213.62it/s] 10%|█         | 3329/32363 [00:33<02:10, 222.86it/s] 10%|█         | 3393/32363 [00:33<02:05, 231.36it/s] 11%|█         | 3457/32363 [00:34<02:01, 237.61it/s] 11%|█         | 3521/32363 [00:34<01:57, 246.03it/s] 11%|█         | 3585/32363 [00:34<01:52, 255.23it/s] 11%|█▏        | 3649/32363 [00:34<01:50, 260.68it/s] 11%|█▏        | 3713/32363 [00:35<01:46, 268.84it/s] 12%|█▏        | 3777/32363 [00:35<01:41, 281.56it/s] 12%|█▏        | 3841/32363 [00:35<01:38, 289.07it/s] 12%|█▏        | 3905/32363 [00:35<01:36, 295.76it/s] 12%|█▏        | 3969/32363 [00:35<01:32, 305.69it/s] 12%|█▏        | 4033/32363 [00:36<01:30, 313.03it/s] 13%|█▎        | 4097/32363 [00:36<01:27, 323.20it/s] 13%|█▎        | 4161/32363 [00:36<01:25, 330.40it/s] 13%|█▎        | 4225/32363 [00:36<01:23, 337.53it/s] 13%|█▎        | 4289/32363 [00:36<01:21, 344.89it/s] 13%|█▎        | 4353/32363 [00:36<01:19, 352.43it/s] 14%|█▎        | 4417/32363 [00:37<01:16, 364.23it/s] 14%|█▍        | 4481/32363 [00:37<01:14, 374.23it/s] 14%|█▍        | 4545/32363 [00:37<01:12, 383.29it/s] 14%|█▍        | 4609/32363 [00:37<01:10, 391.27it/s] 14%|█▍        | 4673/32363 [00:37<01:09, 400.01it/s] 15%|█▍        | 4737/32363 [00:37<01:07, 408.81it/s] 15%|█▍        | 4801/32363 [00:38<01:06, 417.31it/s] 15%|█▌        | 4865/32363 [00:38<01:04, 424.82it/s] 15%|█▌        | 4929/32363 [00:38<01:02, 436.25it/s] 15%|█▌        | 4993/32363 [00:38<01:01, 446.65it/s] 16%|█▌        | 5057/32363 [00:38<01:00, 454.75it/s] 16%|█▌        | 5121/32363 [00:38<00:59, 460.68it/s] 16%|█▌        | 5185/32363 [00:38<00:57, 470.10it/s] 16%|█▌        | 5249/32363 [00:39<00:57, 475.40it/s] 16%|█▋        | 5313/32363 [00:39<00:55, 483.62it/s] 17%|█▋        | 5377/32363 [00:39<00:55, 487.81it/s] 17%|█▋        | 5441/32363 [00:39<00:54, 491.59it/s] 17%|█▋        | 5505/32363 [00:39<00:54, 495.62it/s] 17%|█▋        | 5569/32363 [00:39<00:53, 499.53it/s] 17%|█▋        | 5633/32363 [00:39<00:53, 503.01it/s] 18%|█▊        | 5697/32363 [00:39<00:52, 505.88it/s] 18%|█▊        | 5761/32363 [00:40<00:52, 506.95it/s] 18%|█▊        | 5825/32363 [00:40<00:51, 512.27it/s] 18%|█▊        | 5889/32363 [00:40<00:51, 516.23it/s] 18%|█▊        | 5953/32363 [00:40<00:50, 522.66it/s]Passed argument batch_size = auto:1. Detecting largest batch size
Determined largest batch size: 64
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (126026, 411648), ratio: 0.3061499144917353 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (18757276, 77479680), ratio: 0.24209284292347047 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (43365650, 110527488.0), ratio: 0.39235171978214695 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (12480810731, 45262176768.0), ratio: 0.27574481879147794 
 19%|█▊        | 6017/32363 [00:40<00:50, 521.73it/s] 19%|█▉        | 6081/32363 [00:40<00:50, 522.56it/s] 19%|█▉        | 6145/32363 [00:40<00:49, 526.72it/s] 19%|█▉        | 6209/32363 [00:40<00:49, 531.04it/s] 19%|█▉        | 6273/32363 [00:40<00:49, 530.98it/s] 20%|█▉        | 6337/32363 [00:41<00:48, 537.51it/s] 20%|█▉        | 6401/32363 [00:41<00:48, 536.58it/s] 20%|█▉        | 6465/32363 [00:41<00:48, 539.49it/s] 20%|██        | 6529/32363 [00:41<00:47, 538.40it/s] 20%|██        | 6593/32363 [00:41<00:47, 541.86it/s] 21%|██        | 6657/32363 [00:41<00:47, 545.17it/s] 21%|██        | 6721/32363 [00:41<00:47, 544.19it/s] 21%|██        | 6785/32363 [00:41<00:46, 549.02it/s] 21%|██        | 6849/32363 [00:42<00:46, 547.85it/s] 21%|██▏       | 6913/32363 [00:42<00:46, 551.45it/s] 22%|██▏       | 6977/32363 [00:42<00:46, 550.51it/s] 22%|██▏       | 7041/32363 [00:42<00:45, 553.63it/s] 22%|██▏       | 7105/32363 [00:42<00:45, 553.06it/s] 22%|██▏       | 7169/32363 [00:42<00:45, 556.39it/s] 22%|██▏       | 7233/32363 [00:42<00:45, 555.55it/s] 23%|██▎       | 7297/32363 [00:42<00:45, 553.91it/s] 23%|██▎       | 7361/32363 [00:42<00:44, 564.26it/s] 23%|██▎       | 7425/32363 [00:43<00:44, 566.06it/s] 23%|██▎       | 7489/32363 [00:43<00:43, 571.47it/s] 23%|██▎       | 7553/32363 [00:43<00:43, 571.65it/s] 24%|██▎       | 7617/32363 [00:43<00:42, 576.48it/s] 24%|██▎       | 7681/32363 [00:43<00:42, 576.40it/s] 24%|██▍       | 7745/32363 [00:43<00:42, 580.98it/s] 24%|██▍       | 7809/32363 [00:43<00:42, 581.07it/s] 24%|██▍       | 7873/32363 [00:43<00:41, 585.60it/s] 25%|██▍       | 7937/32363 [00:43<00:41, 585.18it/s] 25%|██▍       | 8001/32363 [00:44<00:41, 590.00it/s] 25%|██▍       | 8065/32363 [00:44<00:41, 589.17it/s] 25%|██▌       | 8129/32363 [00:44<00:41, 588.62it/s] 25%|██▌       | 8193/32363 [00:44<00:40, 592.96it/s] 26%|██▌       | 8257/32363 [00:44<00:40, 592.44it/s] 26%|██▌       | 8321/32363 [00:44<00:40, 591.44it/s] 26%|██▌       | 8385/32363 [00:44<00:40, 595.72it/s] 26%|██▌       | 8449/32363 [00:44<00:40, 595.93it/s] 26%|██▋       | 8513/32363 [00:44<00:39, 602.79it/s] 27%|██▋       | 8577/32363 [00:45<00:39, 602.11it/s] 27%|██▋       | 8641/32363 [00:45<00:39, 600.81it/s] 27%|██▋       | 8705/32363 [00:45<00:39, 605.30it/s] 27%|██▋       | 8769/32363 [00:45<00:39, 604.76it/s] 27%|██▋       | 8833/32363 [00:45<00:38, 609.45it/s] 27%|██▋       | 8897/32363 [00:45<00:38, 612.47it/s] 28%|██▊       | 8961/32363 [00:45<00:38, 610.48it/s] 28%|██▊       | 9025/32363 [00:45<00:38, 614.00it/s] 28%|██▊       | 9089/32363 [00:45<00:37, 612.57it/s] 28%|██▊       | 9153/32363 [00:45<00:38, 610.67it/s] 28%|██▊       | 9217/32363 [00:46<00:37, 615.89it/s] 29%|██▊       | 9281/32363 [00:46<00:37, 615.11it/s] 29%|██▉       | 9345/32363 [00:46<00:37, 619.66it/s] 29%|██▉       | 9409/32363 [00:46<00:36, 622.21it/s] 29%|██▉       | 9473/32363 [00:46<00:36, 620.02it/s] 29%|██▉       | 9537/32363 [00:46<00:36, 624.30it/s] 30%|██▉       | 9601/32363 [00:46<00:36, 623.30it/s] 30%|██▉       | 9665/32363 [00:46<00:36, 627.73it/s] 30%|███       | 9729/32363 [00:46<00:36, 626.91it/s] 30%|███       | 9813/32363 [00:46<00:32, 689.81it/s] 31%|███       | 9883/32363 [00:47<00:32, 688.99it/s] 31%|███       | 9959/32363 [00:47<00:31, 709.97it/s] 31%|███       | 10031/32363 [00:47<00:31, 708.98it/s] 31%|███       | 10113/32363 [00:47<00:38, 577.77it/s] 32%|███▏      | 10198/32363 [00:47<00:34, 645.27it/s] 32%|███▏      | 10300/32363 [00:47<00:29, 743.38it/s] 32%|███▏      | 10379/32363 [00:47<00:36, 600.71it/s] 32%|███▏      | 10492/32363 [00:47<00:30, 725.64it/s] 33%|███▎      | 10574/32363 [00:48<00:35, 606.61it/s] 33%|███▎      | 10666/32363 [00:48<00:32, 677.35it/s] 33%|███▎      | 10753/32363 [00:48<00:36, 598.42it/s] 34%|███▎      | 10881/32363 [00:48<00:34, 628.77it/s] 34%|███▍      | 11008/32363 [00:48<00:27, 764.04it/s] 34%|███▍      | 11094/32363 [00:48<00:31, 665.89it/s] 35%|███▍      | 11201/32363 [00:49<00:32, 652.60it/s] 35%|███▌      | 11329/32363 [00:49<00:30, 686.59it/s] 35%|███▌      | 11457/32363 [00:49<00:29, 718.51it/s] 36%|███▌      | 11585/32363 [00:49<00:27, 754.14it/s] 36%|███▌      | 11713/32363 [00:49<00:25, 798.53it/s] 37%|███▋      | 11841/32363 [00:49<00:24, 838.54it/s] 37%|███▋      | 11969/32363 [00:49<00:23, 880.21it/s] 37%|███▋      | 12097/32363 [00:50<00:21, 921.81it/s] 38%|███▊      | 12225/32363 [00:50<00:20, 961.67it/s] 38%|███▊      | 12353/32363 [00:50<00:19, 1009.83it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (96191, 242688), ratio: 0.39635663897928053 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (30425539, 113603328), ratio: 0.26782260287304904 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (20239182, 38466048.0), ratio: 0.5261570411392528 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16076848271, 53897813760.0), ratio: 0.29828386625454106 
 39%|███▊      | 12481/32363 [00:50<00:18, 1046.95it/s] 39%|███▉      | 12609/32363 [00:50<00:18, 1080.39it/s] 39%|███▉      | 12737/32363 [00:50<00:17, 1111.18it/s] 40%|███▉      | 12865/32363 [00:50<00:17, 1139.56it/s] 40%|████      | 12993/32363 [00:50<00:16, 1157.48it/s] 41%|████      | 13121/32363 [00:50<00:16, 1182.29it/s] 41%|████      | 13249/32363 [00:51<00:15, 1203.40it/s] 41%|████▏     | 13385/32363 [00:51<00:15, 1248.14it/s] 42%|████▏     | 13511/32363 [00:51<00:15, 1249.55it/s] 42%|████▏     | 13660/32363 [00:51<00:14, 1319.94it/s] 43%|████▎     | 13820/32363 [00:51<00:13, 1402.60it/s] 43%|████▎     | 13961/32363 [00:51<00:14, 1264.83it/s] 44%|████▎     | 14145/32363 [00:51<00:14, 1275.96it/s] 44%|████▍     | 14337/32363 [00:51<00:13, 1314.42it/s] 45%|████▍     | 14529/32363 [00:52<00:13, 1336.60it/s] 45%|████▌     | 14721/32363 [00:52<00:12, 1365.56it/s] 46%|████▌     | 14913/32363 [00:52<00:12, 1396.59it/s] 47%|████▋     | 15105/32363 [00:52<00:12, 1422.51it/s] 47%|████▋     | 15297/32363 [00:52<00:11, 1445.92it/s] 48%|████▊     | 15489/32363 [00:52<00:11, 1467.70it/s] 48%|████▊     | 15681/32363 [00:52<00:11, 1486.29it/s] 49%|████▉     | 15873/32363 [00:52<00:10, 1501.39it/s] 50%|████▉     | 16065/32363 [00:53<00:10, 1517.40it/s] 50%|█████     | 16257/32363 [00:53<00:10, 1532.85it/s] 51%|█████     | 16449/32363 [00:53<00:10, 1546.43it/s] 51%|█████▏    | 16641/32363 [00:53<00:10, 1556.66it/s] 52%|█████▏    | 16833/32363 [00:53<00:09, 1570.35it/s] 53%|█████▎    | 17025/32363 [00:53<00:09, 1585.63it/s] 53%|█████▎    | 17217/32363 [00:53<00:09, 1596.44it/s] 54%|█████▍    | 17409/32363 [00:53<00:09, 1604.71it/s] 54%|█████▍    | 17601/32363 [00:54<00:09, 1614.20it/s] 55%|█████▍    | 17793/32363 [00:54<00:08, 1626.71it/s] 56%|█████▌    | 17985/32363 [00:54<00:08, 1643.45it/s] 56%|█████▌    | 18177/32363 [00:54<00:08, 1640.20it/s] 57%|█████▋    | 18369/32363 [00:54<00:08, 1651.58it/s] 57%|█████▋    | 18561/32363 [00:54<00:08, 1662.14it/s] 58%|█████▊    | 18753/32363 [00:54<00:08, 1666.91it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (80400, 168192), ratio: 0.4780251141583545 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (38987261, 132879360), ratio: 0.2934034375240873 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (11754907, 18501120.0), ratio: 0.6353619132247327 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17517248938, 56350587648.0), ratio: 0.3108618679795032 
 59%|█████▊    | 18945/32363 [00:54<00:07, 1680.21it/s] 59%|█████▉    | 19137/32363 [00:54<00:07, 1696.57it/s] 60%|█████▉    | 19329/32363 [00:55<00:07, 1702.32it/s] 60%|██████    | 19521/32363 [00:55<00:07, 1721.43it/s] 61%|██████    | 19713/32363 [00:55<00:07, 1736.20it/s] 62%|██████▏   | 19905/32363 [00:55<00:07, 1750.91it/s] 62%|██████▏   | 20097/32363 [00:55<00:06, 1763.59it/s] 63%|██████▎   | 20289/32363 [00:55<00:06, 1773.12it/s] 63%|██████▎   | 20481/32363 [00:55<00:06, 1788.63it/s] 64%|██████▍   | 20673/32363 [00:55<00:06, 1793.12it/s] 64%|██████▍   | 20865/32363 [00:55<00:06, 1808.10it/s] 65%|██████▌   | 21057/32363 [00:55<00:06, 1818.77it/s] 66%|██████▌   | 21249/32363 [00:56<00:06, 1829.43it/s] 66%|██████▋   | 21441/32363 [00:56<00:05, 1837.64it/s] 67%|██████▋   | 21633/32363 [00:56<00:05, 1845.82it/s] 67%|██████▋   | 21825/32363 [00:56<00:05, 1859.17it/s] 68%|██████▊   | 22017/32363 [00:56<00:05, 1865.96it/s] 69%|██████▊   | 22209/32363 [00:56<00:05, 1875.31it/s] 69%|██████▉   | 22401/32363 [00:56<00:05, 1878.26it/s] 70%|██████▉   | 22603/32363 [00:56<00:05, 1919.75it/s] 70%|███████   | 22796/32363 [00:56<00:04, 1919.32it/s] 71%|███████   | 23006/32363 [00:57<00:04, 1972.75it/s] 72%|███████▏  | 23204/32363 [00:57<00:04, 1969.04it/s] 72%|███████▏  | 23425/32363 [00:57<00:04, 1907.54it/s] 73%|███████▎  | 23681/32363 [00:57<00:04, 1948.28it/s] 74%|███████▍  | 23931/32363 [00:57<00:04, 2099.61it/s] 75%|███████▍  | 24143/32363 [00:57<00:04, 1985.58it/s] 75%|███████▌  | 24385/32363 [00:57<00:04, 1979.48it/s] 76%|███████▌  | 24641/32363 [00:57<00:03, 2010.70it/s] 77%|███████▋  | 24897/32363 [00:57<00:03, 2033.66it/s] 78%|███████▊  | 25153/32363 [00:58<00:03, 2055.11it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (75945, 139008), ratio: 0.5463354627104459 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (46814879, 148181760), ratio: 0.3159287553339944 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (8991348, 12649728.0), ratio: 0.7107937814947712 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (18548074267, 57887092224.0), ratio: 0.32041813734962427 
 79%|███████▊  | 25409/32363 [00:58<00:03, 2072.69it/s] 79%|███████▉  | 25665/32363 [00:58<00:03, 2091.94it/s] 80%|████████  | 25921/32363 [00:58<00:03, 2109.59it/s] 81%|████████  | 26177/32363 [00:58<00:02, 2137.45it/s] 82%|████████▏ | 26433/32363 [00:58<00:02, 2156.80it/s] 82%|████████▏ | 26689/32363 [00:58<00:02, 2171.77it/s] 83%|████████▎ | 26945/32363 [00:58<00:02, 2186.20it/s] 84%|████████▍ | 27201/32363 [00:59<00:02, 2211.34it/s] 85%|████████▍ | 27457/32363 [00:59<00:02, 2229.51it/s] 86%|████████▌ | 27713/32363 [00:59<00:02, 2247.20it/s] 86%|████████▋ | 27969/32363 [00:59<00:01, 2265.96it/s] 87%|████████▋ | 28225/32363 [00:59<00:01, 2293.83it/s] 88%|████████▊ | 28481/32363 [00:59<00:01, 2324.37it/s] 89%|████████▉ | 28737/32363 [00:59<00:01, 2346.57it/s] 90%|████████▉ | 28993/32363 [00:59<00:01, 2377.50it/s] 90%|█████████ | 29249/32363 [00:59<00:01, 2416.96it/s] 91%|█████████ | 29505/32363 [00:59<00:01, 2451.73it/s] 92%|█████████▏| 29761/32363 [01:00<00:01, 2463.39it/s] 93%|█████████▎| 30153/32363 [01:00<00:00, 2888.15it/s] 95%|█████████▍| 30593/32363 [01:00<00:00, 3275.49it/s] 96%|█████████▌| 31100/32363 [01:00<00:00, 3800.01it/s] 97%|█████████▋| 31553/32363 [01:00<00:00, 3998.16it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (14592, 14592), ratio: 1.0 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (52512364, 157763328), ratio: 0.3328553261756792 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (145920, 145920.0), ratio: 1.0 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (19110917529, 58642272000.0), ratio: 0.3258897869611873 
 99%|█████████▉| 32065/32363 [01:00<00:00, 4238.18it/s]100%|██████████| 32363/32363 [01:00<00:00, 533.67it/s] 
2025-01-03:15:27:36,855 INFO     [evaluator.py:319] Running loglikelihood_rolling requests

#################in loglikelihood_rolling#####################
Passed argument batch_size = auto. Detecting largest batch size
Determined Largest batch size: 64
  0%|          | 0/62 [00:00<?, ?it/s]  3%|▎         | 2/62 [00:00<00:03, 15.99it/s]  6%|▋         | 4/62 [00:00<00:04, 13.38it/s] 11%|█▏        | 7/62 [00:00<00:04, 12.53it/s] 15%|█▍        | 9/62 [00:00<00:04, 11.06it/s] 19%|█▉        | 12/62 [00:00<00:04, 12.29it/s] 27%|██▋       | 17/62 [00:01<00:02, 16.80it/s] 32%|███▏      | 20/62 [00:01<00:02, 17.68it/s] 37%|███▋      | 23/62 [00:01<00:02, 18.18it/s] 40%|████      | 25/62 [00:01<00:02, 15.32it/s] 44%|████▎     | 27/62 [00:01<00:02, 12.90it/s] 50%|█████     | 31/62 [00:02<00:01, 17.76it/s] 55%|█████▍    | 34/62 [00:02<00:01, 18.82it/s] 60%|█████▉    | 37/62 [00:02<00:01, 16.56it/s] 63%|██████▎   | 39/62 [00:02<00:01, 13.31it/s] 66%|██████▌   | 41/62 [00:02<00:01, 11.10it/s] 71%|███████   | 44/62 [00:03<00:01, 13.40it/s] 77%|███████▋  | 48/62 [00:03<00:00, 16.17it/s] 84%|████████▍ | 52/62 [00:03<00:00, 19.36it/s] 92%|█████████▏| 57/62 [00:03<00:00, 23.42it/s] 97%|█████████▋| 60/62 [00:03<00:00, 22.49it/s]100%|██████████| 62/62 [00:03<00:00, 16.54it/s]#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################

bootstrapping for stddev: perplexity
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:54,  1.81it/s] 33%|███▎      | 33/100 [00:00<00:01, 42.58it/s] 39%|███▉      | 39/100 [00:01<00:01, 40.56it/s] 65%|██████▌   | 65/100 [00:01<00:00, 59.86it/s] 72%|███████▏  | 72/100 [00:01<00:00, 49.13it/s] 93%|█████████▎| 93/100 [00:01<00:00, 72.22it/s]100%|██████████| 100/100 [00:02<00:00, 46.23it/s]fatal: not a git repository (or any parent up to mount point /lustre)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).

hf (pretrained=/lustre/fast/fast/txiao/shihan/saves/gpt-neox-new_seg/pythia160m-deduped/scaled_masked_softmax_fusion/checkpoints_w64_h2048/hf_checkpoints/global_step143000), gen_kwargs: (), limit: None, num_fewshot: 5, batch_size: auto (64)
|    Tasks     |Version|Filter|n-shot|    Metric     | Value |   |Stderr|
|--------------|-------|------|-----:|---------------|------:|---|-----:|
|arc_challenge |Yaml   |none  |     5|acc            | 0.2056|±  |0.0118|
|              |       |none  |     5|acc_norm       | 0.2440|±  |0.0126|
|arc_easy      |Yaml   |none  |     5|acc            | 0.4827|±  |0.0103|
|              |       |none  |     5|acc_norm       | 0.4499|±  |0.0102|
|lambada_openai|Yaml   |none  |     5|perplexity     |37.3862|±  |1.2870|
|              |       |none  |     5|acc            | 0.3035|±  |0.0064|
|logiqa        |Yaml   |none  |     5|acc            | 0.2611|±  |0.0172|
|              |       |none  |     5|acc_norm       | 0.2765|±  |0.0175|
|piqa          |Yaml   |none  |     5|acc            | 0.6322|±  |0.0113|
|              |       |none  |     5|acc_norm       | 0.6311|±  |0.0113|
|sciq          |Yaml   |none  |     5|acc            | 0.7910|±  |0.0129|
|              |       |none  |     5|acc_norm       | 0.7720|±  |0.0133|
|wikitext      |Yaml   |none  |     5|word_perplexity|30.4669|   |      |
|              |       |none  |     5|byte_perplexity| 1.8945|   |      |
|              |       |none  |     5|bits_per_byte  | 0.9218|   |      |
|winogrande    |Yaml   |none  |     5|acc            | 0.5162|±  |0.0140|
|wsc           |Yaml   |none  |     5|acc            | 0.3558|±  |0.0472|

