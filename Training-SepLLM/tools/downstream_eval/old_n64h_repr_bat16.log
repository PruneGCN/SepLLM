2025-01-03:15:05:49,309 INFO     [utils.py:148] Note: NumExpr detected 32 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-01-03:15:05:50,185 INFO     [config.py:59] PyTorch version 2.1.0+cu121 available.
2025-01-03:15:05:55,495 INFO     [__main__.py:132] Verbosity set to INFO
2025-01-03:15:06:18,784 INFO     [__main__.py:205] Selected Tasks: ['arc_challenge', 'arc_easy', 'lambada_openai', 'logiqa', 'piqa', 'sciq', 'wikitext', 'winogrande', 'wsc']
2025-01-03:15:06:18,790 WARNING  [evaluator.py:93] generation_kwargs specified through cli, these settings will be used over set parameters in yaml tasks.
2025-01-03:15:06:19,958 INFO     [huggingface.py:120] Using device 'cuda:0'
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
2025-01-03:15:06:20,611 WARNING  [huggingface.py:284] WARNING: The number of total system GPUs does not match the number of spawned processes. If you would like to use data parallelism, please launch the script with 'accelerate launch *script*'. Current run will proceed with 1 devices.
2025-01-03:15:06:31,229 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:15:06:31,229 WARNING  [task.py:300] has_training_docs and has_validation_docs are False, using test_docs as fewshot_docs but this is not recommended.
2025-01-03:15:06:41,536 WARNING  [task.py:614] [Task: wikitext] metric word_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:15:06:41,536 WARNING  [task.py:626] [Task: wikitext] metric word_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:06:41,536 WARNING  [task.py:614] [Task: wikitext] metric byte_perplexity is defined, but aggregation is not. using default aggregation=weighted_perplexity
2025-01-03:15:06:41,536 WARNING  [task.py:626] [Task: wikitext] metric byte_perplexity is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:06:41,536 WARNING  [task.py:614] [Task: wikitext] metric bits_per_byte is defined, but aggregation is not. using default aggregation=bits_per_byte
2025-01-03:15:06:41,536 WARNING  [task.py:626] [Task: wikitext] metric bits_per_byte is defined, but higher_is_better is not. using default higher_is_better=False
2025-01-03:15:06:47,799 WARNING  [task.py:614] [Task: wsc] metric acc is defined, but aggregation is not. using default aggregation=mean
2025-01-03:15:06:47,799 WARNING  [task.py:626] [Task: wsc] metric acc is defined, but higher_is_better is not. using default higher_is_better=True
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_challenge from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of arc_easy from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of lambada_openai from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of logiqa from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of piqa from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of sciq from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wikitext from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of winogrande from None to 5
2025-01-03:15:06:50,056 WARNING  [evaluator.py:143] Overwriting default num_fewshot of wsc from None to 5
2025-01-03:15:06:50,056 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:07:01,833 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:07:23,077 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:04,252 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:05,122 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:12,417 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:18,329 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:18,898 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:18,979 INFO     [task.py:355] Building contexts for task on rank 0...
2025-01-03:15:08:18,992 INFO     [evaluator.py:319] Running loglikelihood requests
###########################k and window_size, etc.############################################
prefill_k: 0
decode_k: 0
self.prefill_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.decode_win_size_list: [2048, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64]
self.Layer_num: 12
self.att_sink_max_idx: 2
self.original_flag:  False
self.streamingLLM:  False
self.random_special_tokens_uniform:  False
self.random_special_tokens_general:  False
self.NOT_AVOID_SEP:  False
self.EXCLUDE_DIAGONAL:  True
>>> Please be careful of the special_tokens_id, Make sure they are correct for the current LLM
self.special_tokens_id: [15, 13, 32, 2, 28, 27, 209, 186, 187]
self.floating_window: True
This is about NOT streamingLLM since self.decode_k =0, self.prefill_k = 0 and self.streamingLLM: False
>>>>>>>>---------##########################################################-----------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>------------------ Running our version of the mask strategy-------------------<<<<<<<<
>>>>>>>>---------                                                          -----------<<<<<<<<
>>>>>>>>---------##########################################################-----------<<<<<<<<
#################in loglikelihood#####################
#################in _loglikelihood_tokens#####################
  0%|          | 0/32363 [00:00<?, ?it/s]  0%|          | 1/32363 [00:01<11:08:18,  1.24s/it]  0%|          | 17/32363 [00:01<35:17, 15.28it/s]    0%|          | 33/32363 [00:01<18:54, 28.49it/s]  0%|          | 49/32363 [00:01<13:30, 39.85it/s]  0%|          | 65/32363 [00:02<10:51, 49.54it/s]  0%|          | 81/32363 [00:02<09:16, 58.03it/s]  0%|          | 97/32363 [00:02<08:21, 64.34it/s]  0%|          | 113/32363 [00:02<07:44, 69.50it/s]  0%|          | 129/32363 [00:02<07:16, 73.85it/s]  0%|          | 145/32363 [00:03<06:55, 77.57it/s]  0%|          | 161/32363 [00:03<06:32, 82.02it/s]  1%|          | 177/32363 [00:03<06:21, 84.40it/s]  1%|          | 193/32363 [00:03<06:09, 87.09it/s]  1%|          | 209/32363 [00:03<05:56, 90.24it/s]  1%|          | 225/32363 [00:03<05:53, 91.01it/s]  1%|          | 241/32363 [00:04<05:50, 91.74it/s]  1%|          | 257/32363 [00:04<05:44, 93.29it/s]  1%|          | 273/32363 [00:04<05:38, 94.87it/s]  1%|          | 289/32363 [00:04<05:34, 95.90it/s]  1%|          | 305/32363 [00:04<05:31, 96.82it/s]  1%|          | 321/32363 [00:04<05:31, 96.75it/s]  1%|          | 337/32363 [00:05<05:27, 97.86it/s]  1%|          | 353/32363 [00:05<05:24, 98.79it/s]  1%|          | 369/32363 [00:05<05:21, 99.61it/s]  1%|          | 385/32363 [00:05<05:18, 100.37it/s]  1%|          | 401/32363 [00:05<05:19, 100.19it/s]  1%|▏         | 417/32363 [00:05<05:17, 100.55it/s]  1%|▏         | 433/32363 [00:05<05:16, 101.04it/s]  1%|▏         | 449/32363 [00:06<05:14, 101.50it/s]  1%|▏         | 465/32363 [00:06<05:10, 102.69it/s]  1%|▏         | 481/32363 [00:06<05:07, 103.84it/s]  2%|▏         | 497/32363 [00:06<05:04, 104.49it/s]  2%|▏         | 513/32363 [00:06<05:03, 105.01it/s]  2%|▏         | 529/32363 [00:06<04:58, 106.47it/s]  2%|▏         | 545/32363 [00:07<04:58, 106.73it/s]  2%|▏         | 561/32363 [00:07<04:59, 106.34it/s]  2%|▏         | 577/32363 [00:07<04:57, 106.87it/s]  2%|▏         | 593/32363 [00:07<04:57, 106.72it/s]  2%|▏         | 609/32363 [00:07<04:57, 106.66it/s]  2%|▏         | 625/32363 [00:07<04:55, 107.48it/s]  2%|▏         | 641/32363 [00:07<04:52, 108.52it/s]  2%|▏         | 657/32363 [00:08<04:50, 108.96it/s]  2%|▏         | 673/32363 [00:08<04:49, 109.42it/s]  2%|▏         | 689/32363 [00:08<04:48, 109.83it/s]  2%|▏         | 705/32363 [00:08<04:44, 111.46it/s]  2%|▏         | 721/32363 [00:08<04:43, 111.47it/s]  2%|▏         | 737/32363 [00:08<04:43, 111.64it/s]  2%|▏         | 753/32363 [00:08<04:44, 110.93it/s]  2%|▏         | 769/32363 [00:09<04:42, 111.78it/s]  2%|▏         | 785/32363 [00:09<04:41, 112.17it/s]  2%|▏         | 801/32363 [00:09<04:40, 112.44it/s]  3%|▎         | 817/32363 [00:09<04:39, 112.76it/s]  3%|▎         | 833/32363 [00:09<04:40, 112.31it/s]  3%|▎         | 849/32363 [00:09<04:41, 112.04it/s]  3%|▎         | 865/32363 [00:09<04:41, 111.94it/s]  3%|▎         | 881/32363 [00:10<04:40, 112.08it/s]  3%|▎         | 897/32363 [00:10<04:39, 112.50it/s]  3%|▎         | 913/32363 [00:10<04:36, 113.69it/s]  3%|▎         | 929/32363 [00:10<04:36, 113.75it/s]  3%|▎         | 945/32363 [00:10<04:35, 113.88it/s]  3%|▎         | 961/32363 [00:10<04:35, 114.13it/s]  3%|▎         | 977/32363 [00:10<04:32, 115.31it/s]  3%|▎         | 993/32363 [00:11<04:31, 115.53it/s]  3%|▎         | 1009/32363 [00:11<04:28, 116.66it/s]  3%|▎         | 1025/32363 [00:11<04:28, 116.62it/s]  3%|▎         | 1041/32363 [00:11<04:28, 116.72it/s]  3%|▎         | 1057/32363 [00:11<04:27, 117.15it/s]  3%|▎         | 1073/32363 [00:11<04:21, 119.88it/s]  3%|▎         | 1089/32363 [00:11<04:18, 120.79it/s]  3%|▎         | 1105/32363 [00:11<04:17, 121.54it/s]  3%|▎         | 1121/32363 [00:12<04:16, 121.60it/s]  4%|▎         | 1137/32363 [00:12<04:19, 120.44it/s]  4%|▎         | 1153/32363 [00:12<04:20, 119.81it/s]  4%|▎         | 1169/32363 [00:12<04:21, 119.43it/s]  4%|▎         | 1185/32363 [00:12<04:21, 119.16it/s]  4%|▎         | 1201/32363 [00:12<04:21, 119.06it/s]  4%|▍         | 1217/32363 [00:12<04:21, 119.11it/s]  4%|▍         | 1233/32363 [00:13<04:18, 120.55it/s]  4%|▍         | 1249/32363 [00:13<04:14, 122.34it/s]  4%|▍         | 1265/32363 [00:13<04:12, 123.02it/s]  4%|▍         | 1281/32363 [00:13<04:14, 122.26it/s]  4%|▍         | 1297/32363 [00:13<04:09, 124.72it/s]  4%|▍         | 1313/32363 [00:13<04:08, 125.15it/s]  4%|▍         | 1329/32363 [00:13<04:06, 126.08it/s]  4%|▍         | 1345/32363 [00:13<04:05, 126.28it/s]  4%|▍         | 1361/32363 [00:14<04:07, 125.15it/s]  4%|▍         | 1377/32363 [00:14<04:08, 124.48it/s]  4%|▍         | 1393/32363 [00:14<04:05, 125.99it/s]  4%|▍         | 1409/32363 [00:14<04:04, 126.55it/s]  4%|▍         | 1425/32363 [00:14<04:01, 128.15it/s]  4%|▍         | 1441/32363 [00:14<04:03, 126.86it/s]  5%|▍         | 1457/32363 [00:14<04:01, 128.17it/s]  5%|▍         | 1473/32363 [00:14<04:00, 128.56it/s]  5%|▍         | 1489/32363 [00:15<04:02, 127.39it/s]  5%|▍         | 1505/32363 [00:15<04:03, 126.67it/s]  5%|▍         | 1521/32363 [00:15<04:04, 126.35it/s]  5%|▍         | 1537/32363 [00:15<04:01, 127.70it/s]  5%|▍         | 1553/32363 [00:15<03:55, 130.63it/s]  5%|▍         | 1569/32363 [00:15<03:54, 131.06it/s]###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (60938, 233088), ratio: 0.26143774025577704 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (6391334, 25782720), ratio: 0.2478921541249625 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (42770446, 141600960.0), ratio: 0.3020491245257143 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (5024710439, 17646263424.0), ratio: 0.2847464258164755 
  5%|▍         | 1585/32363 [00:15<03:52, 132.10it/s]  5%|▍         | 1601/32363 [00:15<03:52, 132.29it/s]  5%|▍         | 1617/32363 [00:16<03:54, 130.96it/s]  5%|▌         | 1633/32363 [00:16<03:53, 131.66it/s]  5%|▌         | 1649/32363 [00:16<03:54, 130.84it/s]  5%|▌         | 1665/32363 [00:16<03:55, 130.33it/s]  5%|▌         | 1681/32363 [00:16<03:51, 132.60it/s]  5%|▌         | 1697/32363 [00:16<03:50, 133.17it/s]  5%|▌         | 1713/32363 [00:16<03:48, 134.34it/s]  5%|▌         | 1729/32363 [00:16<03:50, 133.11it/s]  5%|▌         | 1745/32363 [00:17<03:51, 132.39it/s]  5%|▌         | 1761/32363 [00:17<03:51, 131.97it/s]  5%|▌         | 1777/32363 [00:17<03:48, 133.86it/s]  6%|▌         | 1793/32363 [00:17<03:49, 133.10it/s]  6%|▌         | 1809/32363 [00:17<03:50, 132.82it/s]  6%|▌         | 1825/32363 [00:17<03:47, 134.33it/s]  6%|▌         | 1841/32363 [00:17<03:45, 135.33it/s]  6%|▌         | 1857/32363 [00:17<03:42, 136.86it/s]  6%|▌         | 1873/32363 [00:17<03:41, 137.37it/s]  6%|▌         | 1889/32363 [00:18<03:43, 136.44it/s]  6%|▌         | 1905/32363 [00:18<03:44, 135.73it/s]  6%|▌         | 1921/32363 [00:18<03:44, 135.36it/s]  6%|▌         | 1937/32363 [00:18<03:44, 135.35it/s]  6%|▌         | 1953/32363 [00:18<03:40, 138.15it/s]  6%|▌         | 1969/32363 [00:18<03:38, 139.00it/s]  6%|▌         | 1985/32363 [00:18<03:39, 138.08it/s]  6%|▌         | 2001/32363 [00:18<03:38, 139.17it/s]  6%|▌         | 2017/32363 [00:18<03:39, 138.35it/s]  6%|▋         | 2033/32363 [00:19<03:39, 137.95it/s]  6%|▋         | 2049/32363 [00:19<03:39, 137.85it/s]  6%|▋         | 2065/32363 [00:19<03:39, 137.96it/s]  6%|▋         | 2081/32363 [00:19<03:39, 138.12it/s]  6%|▋         | 2097/32363 [00:19<03:38, 138.76it/s]  7%|▋         | 2113/32363 [00:19<03:34, 141.12it/s]  7%|▋         | 2129/32363 [00:19<03:34, 140.95it/s]  7%|▋         | 2145/32363 [00:19<03:34, 140.96it/s]  7%|▋         | 2161/32363 [00:20<03:33, 141.22it/s]  7%|▋         | 2177/32363 [00:20<03:31, 142.77it/s]  7%|▋         | 2193/32363 [00:20<03:27, 145.33it/s]  7%|▋         | 2209/32363 [00:20<03:28, 144.61it/s]  7%|▋         | 2225/32363 [00:20<03:26, 145.69it/s]  7%|▋         | 2241/32363 [00:20<03:27, 145.08it/s]  7%|▋         | 2257/32363 [00:20<03:27, 144.79it/s]  7%|▋         | 2273/32363 [00:20<03:24, 146.79it/s]  7%|▋         | 2289/32363 [00:20<03:23, 147.63it/s]  7%|▋         | 2305/32363 [00:20<03:24, 147.34it/s]  7%|▋         | 2321/32363 [00:21<03:22, 148.31it/s]  7%|▋         | 2337/32363 [00:21<03:23, 147.84it/s]  7%|▋         | 2353/32363 [00:21<03:21, 148.90it/s]  7%|▋         | 2369/32363 [00:21<03:21, 148.58it/s]  7%|▋         | 2385/32363 [00:21<03:21, 148.49it/s]  7%|▋         | 2401/32363 [00:21<03:21, 148.53it/s]  7%|▋         | 2417/32363 [00:21<03:17, 151.59it/s]  8%|▊         | 2433/32363 [00:21<03:18, 151.02it/s]  8%|▊         | 2450/32363 [00:21<03:11, 156.46it/s]  8%|▊         | 2466/32363 [00:22<03:10, 157.27it/s]  8%|▊         | 2482/32363 [00:22<03:11, 155.99it/s]  8%|▊         | 2498/32363 [00:22<03:12, 155.30it/s]  8%|▊         | 2514/32363 [00:22<03:10, 156.43it/s]  8%|▊         | 2545/32363 [00:22<03:11, 155.70it/s]  8%|▊         | 2561/32363 [00:22<03:11, 155.68it/s]  8%|▊         | 2591/32363 [00:22<02:34, 192.91it/s]  8%|▊         | 2611/32363 [00:22<03:13, 153.89it/s]  8%|▊         | 2628/32363 [00:23<03:08, 157.38it/s]  8%|▊         | 2653/32363 [00:23<02:44, 180.47it/s]  8%|▊         | 2673/32363 [00:23<03:20, 148.36it/s]  8%|▊         | 2705/32363 [00:23<03:12, 154.37it/s]  8%|▊         | 2737/32363 [00:23<03:06, 158.45it/s]  9%|▊         | 2769/32363 [00:23<02:58, 166.15it/s]  9%|▊         | 2801/32363 [00:24<02:52, 171.68it/s]  9%|▉         | 2833/32363 [00:24<02:47, 176.77it/s]  9%|▉         | 2865/32363 [00:24<02:43, 180.30it/s]  9%|▉         | 2897/32363 [00:24<02:40, 183.23it/s]  9%|▉         | 2929/32363 [00:24<02:38, 185.83it/s]  9%|▉         | 2961/32363 [00:24<02:37, 186.56it/s]  9%|▉         | 2993/32363 [00:25<02:35, 189.12it/s]  9%|▉         | 3025/32363 [00:25<02:32, 192.63it/s]  9%|▉         | 3057/32363 [00:25<02:29, 195.53it/s] 10%|▉         | 3089/32363 [00:25<02:27, 198.43it/s] 10%|▉         | 3121/32363 [00:25<02:26, 199.83it/s] 10%|▉         | 3153/32363 [00:25<02:24, 201.72it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (45764, 177984), ratio: 0.2571242358905456 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (11827813, 46756224), ratio: 0.2529676690744049 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (25756432, 82584576.0), ratio: 0.3118794482882698 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (8534554536, 29178506304.0), ratio: 0.2924945659343098 
 10%|▉         | 3185/32363 [00:26<02:22, 204.30it/s] 10%|▉         | 3217/32363 [00:26<02:20, 207.14it/s] 10%|█         | 3249/32363 [00:26<02:17, 211.91it/s] 10%|█         | 3281/32363 [00:26<02:14, 215.78it/s] 10%|█         | 3313/32363 [00:26<02:12, 219.91it/s] 10%|█         | 3345/32363 [00:26<02:08, 225.08it/s] 10%|█         | 3377/32363 [00:26<02:06, 228.30it/s] 11%|█         | 3409/32363 [00:27<02:04, 233.31it/s] 11%|█         | 3441/32363 [00:27<02:02, 236.16it/s] 11%|█         | 3473/32363 [00:27<02:01, 238.21it/s] 11%|█         | 3505/32363 [00:27<01:58, 242.96it/s] 11%|█         | 3537/32363 [00:27<01:56, 247.40it/s] 11%|█         | 3569/32363 [00:27<01:54, 251.74it/s] 11%|█         | 3601/32363 [00:27<01:52, 256.04it/s] 11%|█         | 3633/32363 [00:27<01:51, 257.15it/s] 11%|█▏        | 3665/32363 [00:28<01:49, 261.26it/s] 11%|█▏        | 3697/32363 [00:28<01:48, 265.01it/s] 12%|█▏        | 3729/32363 [00:28<01:46, 269.64it/s] 12%|█▏        | 3761/32363 [00:28<01:44, 272.57it/s] 12%|█▏        | 3793/32363 [00:28<01:42, 279.54it/s] 12%|█▏        | 3825/32363 [00:28<01:40, 283.65it/s] 12%|█▏        | 3857/32363 [00:28<01:39, 287.13it/s] 12%|█▏        | 3889/32363 [00:28<01:38, 290.28it/s] 12%|█▏        | 3921/32363 [00:28<01:37, 291.84it/s] 12%|█▏        | 3953/32363 [00:28<01:36, 295.88it/s] 12%|█▏        | 3985/32363 [00:29<01:34, 299.78it/s] 12%|█▏        | 4017/32363 [00:29<01:33, 302.84it/s] 13%|█▎        | 4049/32363 [00:29<01:32, 305.86it/s] 13%|█▎        | 4090/32363 [00:29<01:24, 336.05it/s] 13%|█▎        | 4129/32363 [00:29<01:30, 311.71it/s] 13%|█▎        | 4177/32363 [00:29<01:27, 321.21it/s] 13%|█▎        | 4225/32363 [00:29<01:25, 327.89it/s] 13%|█▎        | 4273/32363 [00:29<01:23, 335.03it/s] 13%|█▎        | 4321/32363 [00:30<01:22, 340.35it/s] 13%|█▎        | 4369/32363 [00:30<01:21, 345.49it/s] 14%|█▎        | 4417/32363 [00:30<01:19, 353.38it/s] 14%|█▍        | 4465/32363 [00:30<01:17, 357.83it/s] 14%|█▍        | 4513/32363 [00:30<01:16, 363.70it/s] 14%|█▍        | 4561/32363 [00:30<01:15, 369.57it/s] 14%|█▍        | 4609/32363 [00:30<01:14, 374.72it/s] 14%|█▍        | 4657/32363 [00:30<01:12, 382.81it/s] 15%|█▍        | 4705/32363 [00:31<01:10, 390.02it/s] 15%|█▍        | 4753/32363 [00:31<01:09, 396.12it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (33703, 116736), ratio: 0.28871128015960196 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (15653084, 61012608), ratio: 0.2565549074709402 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (13040369, 35546112.0), ratio: 0.3668578155608308 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (10325287371, 34556641536.0), ratio: 0.29879313822332676 
 15%|█▍        | 4801/32363 [00:31<01:08, 402.83it/s] 15%|█▍        | 4849/32363 [00:31<01:07, 408.94it/s] 15%|█▌        | 4897/32363 [00:31<01:06, 413.14it/s] 15%|█▌        | 4945/32363 [00:31<01:05, 419.47it/s] 15%|█▌        | 4993/32363 [00:31<01:04, 425.57it/s] 16%|█▌        | 5041/32363 [00:31<01:03, 430.22it/s] 16%|█▌        | 5089/32363 [00:32<01:02, 436.98it/s] 16%|█▌        | 5137/32363 [00:32<01:01, 442.05it/s] 16%|█▌        | 5185/32363 [00:32<01:00, 447.96it/s] 16%|█▌        | 5233/32363 [00:32<00:59, 454.32it/s] 16%|█▋        | 5281/32363 [00:32<00:59, 457.76it/s] 16%|█▋        | 5329/32363 [00:32<00:58, 460.65it/s] 17%|█▋        | 5377/32363 [00:32<00:58, 463.71it/s] 17%|█▋        | 5425/32363 [00:32<00:57, 467.04it/s] 17%|█▋        | 5473/32363 [00:32<00:57, 470.11it/s] 17%|█▋        | 5535/32363 [00:32<00:52, 514.36it/s] 17%|█▋        | 5587/32363 [00:33<00:56, 472.59it/s] 17%|█▋        | 5649/32363 [00:33<00:56, 474.34it/s] 18%|█▊        | 5713/32363 [00:33<00:55, 479.60it/s] 18%|█▊        | 5777/32363 [00:33<00:55, 481.55it/s] 18%|█▊        | 5841/32363 [00:33<00:54, 486.56it/s] 18%|█▊        | 5905/32363 [00:33<00:54, 488.17it/s] 18%|█▊        | 5969/32363 [00:33<00:53, 490.68it/s] 19%|█▊        | 6033/32363 [00:33<00:53, 492.39it/s] 19%|█▉        | 6097/32363 [00:34<00:53, 493.05it/s] 19%|█▉        | 6161/32363 [00:34<00:52, 496.06it/s] 19%|█▉        | 6225/32363 [00:34<00:52, 497.42it/s] 19%|█▉        | 6289/32363 [00:34<00:52, 498.24it/s] 20%|█▉        | 6353/32363 [00:34<00:51, 503.62it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (31346, 101376), ratio: 0.30920533460277383 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (18847137, 71637696), ratio: 0.263089658829909 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (10686386, 26813952.0), ratio: 0.398538268435798 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (11459671583, 37506397632.0), ratio: 0.305539116164618 
 20%|█▉        | 6417/32363 [00:34<00:51, 504.82it/s] 20%|██        | 6481/32363 [00:34<00:50, 508.16it/s] 20%|██        | 6545/32363 [00:34<00:50, 508.75it/s] 20%|██        | 6609/32363 [00:35<00:50, 511.87it/s] 21%|██        | 6673/32363 [00:35<00:50, 513.42it/s] 21%|██        | 6737/32363 [00:35<00:49, 513.37it/s] 21%|██        | 6801/32363 [00:35<00:49, 515.36it/s] 21%|██        | 6865/32363 [00:35<00:49, 517.29it/s] 21%|██▏       | 6929/32363 [00:35<00:49, 518.31it/s] 22%|██▏       | 6993/32363 [00:35<00:48, 519.58it/s] 22%|██▏       | 7057/32363 [00:35<00:48, 522.20it/s] 22%|██▏       | 7121/32363 [00:36<00:48, 522.31it/s] 22%|██▏       | 7185/32363 [00:36<00:48, 523.38it/s] 22%|██▏       | 7249/32363 [00:36<00:47, 524.62it/s] 23%|██▎       | 7313/32363 [00:36<00:47, 525.53it/s] 23%|██▎       | 7377/32363 [00:36<00:47, 531.39it/s] 23%|██▎       | 7441/32363 [00:36<00:46, 532.69it/s] 23%|██▎       | 7505/32363 [00:36<00:46, 535.57it/s] 23%|██▎       | 7569/32363 [00:36<00:46, 536.36it/s] 24%|██▎       | 7633/32363 [00:37<00:45, 539.13it/s] 24%|██▍       | 7697/32363 [00:37<00:45, 539.14it/s] 24%|██▍       | 7761/32363 [00:37<00:45, 541.76it/s] 24%|██▍       | 7825/32363 [00:37<00:45, 541.72it/s] 24%|██▍       | 7889/32363 [00:37<00:44, 544.00it/s] 25%|██▍       | 7953/32363 [00:37<00:44, 545.11it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (30608, 96576), ratio: 0.31693174288314974 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (21915410, 81516288), ratio: 0.2688470063798873 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (9939691, 24337152.0), ratio: 0.4084163586602324 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (12477176604, 40053125952.0), ratio: 0.311515675928834 
 25%|██▍       | 8017/32363 [00:37<00:44, 546.53it/s] 25%|██▍       | 8081/32363 [00:37<00:44, 547.41it/s] 25%|██▌       | 8145/32363 [00:37<00:44, 547.02it/s] 25%|██▌       | 8209/32363 [00:38<00:43, 549.86it/s] 26%|██▌       | 8273/32363 [00:38<00:43, 550.40it/s] 26%|██▌       | 8337/32363 [00:38<00:43, 550.54it/s] 26%|██▌       | 8401/32363 [00:38<00:43, 552.78it/s] 26%|██▌       | 8465/32363 [00:38<00:43, 552.41it/s] 26%|██▋       | 8529/32363 [00:38<00:42, 554.55it/s] 27%|██▋       | 8593/32363 [00:38<00:42, 556.04it/s] 27%|██▋       | 8657/32363 [00:38<00:42, 556.14it/s] 27%|██▋       | 8721/32363 [00:39<00:42, 559.93it/s] 27%|██▋       | 8785/32363 [00:39<00:42, 560.49it/s] 27%|██▋       | 8849/32363 [00:39<00:41, 562.09it/s] 28%|██▊       | 8913/32363 [00:39<00:41, 565.01it/s] 28%|██▊       | 8977/32363 [00:39<00:41, 564.32it/s] 28%|██▊       | 9041/32363 [00:39<00:41, 566.34it/s] 28%|██▊       | 9105/32363 [00:39<00:41, 566.33it/s] 28%|██▊       | 9169/32363 [00:39<00:40, 566.82it/s] 29%|██▊       | 9233/32363 [00:39<00:40, 570.84it/s] 29%|██▊       | 9297/32363 [00:40<00:40, 569.58it/s] 29%|██▉       | 9361/32363 [00:40<00:40, 571.35it/s] 29%|██▉       | 9425/32363 [00:40<00:40, 572.60it/s] 29%|██▉       | 9489/32363 [00:40<00:39, 572.52it/s] 30%|██▉       | 9553/32363 [00:40<00:39, 575.46it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (30388, 92736), ratio: 0.32768288475535196 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (24920897, 90983232), ratio: 0.27390648202078294 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (9411424, 22442112.0), ratio: 0.4193644519731735 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (13433462242, 42392087040.0), ratio: 0.3168860789827252 
 30%|██▉       | 9617/32363 [00:40<00:39, 574.46it/s] 30%|██▉       | 9681/32363 [00:40<00:39, 577.14it/s] 30%|███       | 9745/32363 [00:40<00:39, 576.10it/s] 30%|███       | 9809/32363 [00:40<00:38, 581.32it/s] 31%|███       | 9873/32363 [00:41<00:38, 579.99it/s] 31%|███       | 9937/32363 [00:41<00:38, 581.14it/s] 31%|███       | 10001/32363 [00:41<00:38, 581.09it/s] 31%|███       | 10065/32363 [00:41<00:38, 582.72it/s] 31%|███▏      | 10129/32363 [00:41<00:38, 581.97it/s] 31%|███▏      | 10193/32363 [00:41<00:37, 583.46it/s] 32%|███▏      | 10257/32363 [00:41<00:37, 585.45it/s] 32%|███▏      | 10321/32363 [00:41<00:37, 586.48it/s] 32%|███▏      | 10385/32363 [00:41<00:37, 588.40it/s] 32%|███▏      | 10449/32363 [00:41<00:37, 591.10it/s] 32%|███▏      | 10513/32363 [00:42<00:36, 592.36it/s] 33%|███▎      | 10577/32363 [00:42<00:36, 594.24it/s] 33%|███▎      | 10641/32363 [00:42<00:36, 596.69it/s] 33%|███▎      | 10705/32363 [00:42<00:36, 598.52it/s] 33%|███▎      | 10769/32363 [00:42<00:35, 601.04it/s] 33%|███▎      | 10833/32363 [00:42<00:35, 602.47it/s] 34%|███▎      | 10897/32363 [00:42<00:35, 605.96it/s] 34%|███▍      | 10961/32363 [00:42<00:35, 608.41it/s] 34%|███▍      | 11025/32363 [00:42<00:34, 612.01it/s] 34%|███▍      | 11093/32363 [00:43<00:33, 631.69it/s] 35%|███▍      | 11169/32363 [00:43<00:33, 629.16it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (28420, 83712), ratio: 0.33949732416691164 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (27852107, 99951744), ratio: 0.2786555380164324 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (8049523, 18291072.0), ratio: 0.4400793458142071 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (14319050730, 44492567424.0), ratio: 0.3218301743197691 
 35%|███▍      | 11249/32363 [00:43<00:33, 639.42it/s] 35%|███▌      | 11329/32363 [00:43<00:32, 651.59it/s] 35%|███▌      | 11409/32363 [00:43<00:31, 664.25it/s] 36%|███▌      | 11489/32363 [00:43<00:30, 682.68it/s] 36%|███▌      | 11569/32363 [00:43<00:29, 700.51it/s] 36%|███▌      | 11649/32363 [00:43<00:28, 721.74it/s] 36%|███▌      | 11729/32363 [00:43<00:27, 741.42it/s] 37%|███▋      | 11825/32363 [00:44<00:26, 764.10it/s] 37%|███▋      | 11921/32363 [00:44<00:25, 791.40it/s] 37%|███▋      | 12017/32363 [00:44<00:24, 815.94it/s] 37%|███▋      | 12113/32363 [00:44<00:24, 836.73it/s] 38%|███▊      | 12209/32363 [00:44<00:23, 854.79it/s] 38%|███▊      | 12305/32363 [00:44<00:22, 876.94it/s] 38%|███▊      | 12410/32363 [00:44<00:21, 926.17it/s] 39%|███▊      | 12513/32363 [00:44<00:21, 923.32it/s] 39%|███▉      | 12625/32363 [00:44<00:20, 948.26it/s] 39%|███▉      | 12737/32363 [00:45<00:20, 967.35it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (23314, 57216), ratio: 0.4074734340148302 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (30379892, 106703424), ratio: 0.28471337527088836 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (4675236, 8553792.0), ratio: 0.5465688200040933 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (14910449326, 45698853120.0), ratio: 0.3262762259448143 
 40%|███▉      | 12849/32363 [00:45<00:19, 985.24it/s] 40%|████      | 12961/32363 [00:45<00:19, 1001.14it/s] 40%|████      | 13073/32363 [00:45<00:19, 1014.05it/s] 41%|████      | 13185/32363 [00:45<00:18, 1030.55it/s] 41%|████      | 13297/32363 [00:45<00:18, 1041.33it/s] 41%|████▏     | 13409/32363 [00:45<00:17, 1054.23it/s] 42%|████▏     | 13521/32363 [00:45<00:17, 1064.41it/s] 42%|████▏     | 13633/32363 [00:45<00:17, 1075.36it/s] 42%|████▏     | 13745/32363 [00:45<00:17, 1085.84it/s] 43%|████▎     | 13857/32363 [00:46<00:16, 1095.14it/s] 43%|████▎     | 13969/32363 [00:46<00:16, 1102.04it/s] 44%|████▎     | 14086/32363 [00:46<00:16, 1122.14it/s] 44%|████▍     | 14206/32363 [00:46<00:15, 1145.12it/s] 44%|████▍     | 14321/32363 [00:46<00:16, 1110.47it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (22018, 50112), ratio: 0.43937579822319256 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (32619416, 112024512), ratio: 0.29118105865973964 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (3805938, 6564672.0), ratio: 0.5797605729578599 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (15324002303, 46439927040.0), ratio: 0.32997472820749724 
 45%|████▍     | 14449/32363 [00:46<00:15, 1122.81it/s] 45%|████▌     | 14577/32363 [00:46<00:15, 1131.10it/s] 45%|████▌     | 14705/32363 [00:46<00:15, 1142.58it/s] 46%|████▌     | 14833/32363 [00:46<00:15, 1157.61it/s] 46%|████▌     | 14961/32363 [00:47<00:14, 1170.26it/s] 47%|████▋     | 15089/32363 [00:47<00:14, 1181.73it/s] 47%|████▋     | 15217/32363 [00:47<00:14, 1191.81it/s] 47%|████▋     | 15345/32363 [00:47<00:14, 1200.05it/s] 48%|████▊     | 15473/32363 [00:47<00:13, 1208.65it/s] 48%|████▊     | 15601/32363 [00:47<00:13, 1215.30it/s] 49%|████▊     | 15729/32363 [00:47<00:13, 1222.22it/s] 49%|████▉     | 15857/32363 [00:47<00:13, 1226.88it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (20532, 46272), ratio: 0.44372406640206336 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (34763580, 116828928), ratio: 0.2975596934348375 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (3324035, 5598912.0), ratio: 0.5936930246448606 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (15681398076, 47043754560.0), ratio: 0.33333644864590506 
 49%|████▉     | 15985/32363 [00:47<00:13, 1232.04it/s] 50%|████▉     | 16113/32363 [00:47<00:13, 1243.40it/s] 50%|█████     | 16241/32363 [00:48<00:12, 1244.87it/s] 51%|█████     | 16369/32363 [00:48<00:12, 1251.15it/s] 51%|█████     | 16497/32363 [00:48<00:12, 1256.62it/s] 51%|█████▏    | 16625/32363 [00:48<00:12, 1258.62it/s] 52%|█████▏    | 16755/32363 [00:48<00:12, 1270.69it/s] 52%|█████▏    | 16883/32363 [00:48<00:12, 1269.18it/s] 53%|█████▎    | 17025/32363 [00:48<00:12, 1276.86it/s] 53%|█████▎    | 17163/32363 [00:48<00:11, 1306.93it/s] 53%|█████▎    | 17294/32363 [00:48<00:11, 1304.30it/s] 54%|█████▍    | 17425/32363 [00:48<00:11, 1269.07it/s] 54%|█████▍    | 17568/32363 [00:49<00:11, 1315.59it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (20440, 43584), ratio: 0.46897944200924696 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (36845976, 121312512), ratio: 0.3037277473901513 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (3103460, 4968576.0), ratio: 0.6246175966716369 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16004682860, 47569663104.0), ratio: 0.3364472610413382 
 55%|█████▍    | 17700/32363 [00:49<00:11, 1283.51it/s] 55%|█████▌    | 17841/32363 [00:49<00:11, 1283.01it/s] 56%|█████▌    | 17985/32363 [00:49<00:11, 1304.65it/s] 56%|█████▌    | 18129/32363 [00:49<00:10, 1316.78it/s] 56%|█████▋    | 18273/32363 [00:49<00:10, 1320.38it/s] 57%|█████▋    | 18417/32363 [00:49<00:10, 1320.71it/s] 57%|█████▋    | 18561/32363 [00:49<00:10, 1327.31it/s] 58%|█████▊    | 18705/32363 [00:49<00:10, 1331.50it/s] 58%|█████▊    | 18849/32363 [00:50<00:10, 1333.20it/s] 59%|█████▊    | 18993/32363 [00:50<00:10, 1335.53it/s] 59%|█████▉    | 19137/32363 [00:50<00:09, 1347.33it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (20396, 41472), ratio: 0.4918016975431182 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (38887095, 125559168), ratio: 0.30971131474844343 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2917527, 4499712.0), ratio: 0.6483808297065126 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16303804484, 48041520768.0), ratio: 0.3393690337725489 
 60%|█████▉    | 19281/32363 [00:50<00:09, 1355.16it/s] 60%|██████    | 19425/32363 [00:50<00:09, 1357.43it/s] 60%|██████    | 19569/32363 [00:50<00:09, 1361.27it/s] 61%|██████    | 19713/32363 [00:50<00:09, 1366.07it/s] 61%|██████▏   | 19857/32363 [00:50<00:09, 1372.89it/s] 62%|██████▏   | 20001/32363 [00:50<00:09, 1372.47it/s] 62%|██████▏   | 20145/32363 [00:51<00:08, 1381.69it/s] 63%|██████▎   | 20289/32363 [00:51<00:08, 1382.01it/s] 63%|██████▎   | 20433/32363 [00:51<00:08, 1392.43it/s] 64%|██████▎   | 20577/32363 [00:51<00:08, 1401.88it/s] 64%|██████▍   | 20721/32363 [00:51<00:08, 1403.04it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (19928, 39552), ratio: 0.5038430420837419 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (40892582, 129604992), ratio: 0.315517028850252 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2706356, 4093632.0), ratio: 0.6611136516424385 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16583005946, 48469886016.0), ratio: 0.34213007929347966 
 64%|██████▍   | 20865/32363 [00:51<00:08, 1410.47it/s] 65%|██████▍   | 21009/32363 [00:51<00:08, 1411.25it/s] 65%|██████▌   | 21153/32363 [00:51<00:07, 1417.81it/s] 66%|██████▌   | 21297/32363 [00:51<00:07, 1420.77it/s] 66%|██████▋   | 21441/32363 [00:51<00:07, 1421.79it/s] 67%|██████▋   | 21585/32363 [00:52<00:07, 1426.87it/s] 67%|██████▋   | 21729/32363 [00:52<00:07, 1427.23it/s] 68%|██████▊   | 21889/32363 [00:52<00:07, 1443.39it/s] 68%|██████▊   | 22041/32363 [00:52<00:07, 1465.83it/s] 69%|██████▊   | 22193/32363 [00:52<00:07, 1443.51it/s] 69%|██████▉   | 22353/32363 [00:52<00:06, 1449.08it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (19729, 37824), ratio: 0.5216000423138325 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (42859395, 133473792), ratio: 0.3211071953361502 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2550218, 3744576.0), ratio: 0.681043194209523 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (16844574756, 48861669888.0), ratio: 0.3447400548243825 
 70%|██████▉   | 22513/32363 [00:52<00:06, 1456.15it/s] 70%|███████   | 22673/32363 [00:52<00:06, 1462.63it/s] 71%|███████   | 22833/32363 [00:52<00:06, 1464.58it/s] 71%|███████   | 22993/32363 [00:52<00:06, 1475.49it/s] 72%|███████▏  | 23153/32363 [00:53<00:06, 1477.74it/s] 72%|███████▏  | 23313/32363 [00:53<00:06, 1507.79it/s] 73%|███████▎  | 23473/32363 [00:53<00:05, 1519.60it/s] 73%|███████▎  | 23633/32363 [00:53<00:05, 1533.33it/s] 74%|███████▎  | 23793/32363 [00:53<00:05, 1540.73it/s] 74%|███████▍  | 23953/32363 [00:53<00:05, 1549.01it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (19090, 36096), ratio: 0.5288674645520594 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (44793920, 137167872), ratio: 0.3265627682844031 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2371671, 3411072.0), ratio: 0.6952861153327472 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17089617669, 49218954816.0), ratio: 0.34721618394555065 
 75%|███████▍  | 24113/32363 [00:53<00:05, 1555.61it/s] 75%|███████▌  | 24273/32363 [00:53<00:05, 1562.64it/s] 75%|███████▌  | 24433/32363 [00:53<00:05, 1569.42it/s] 76%|███████▌  | 24593/32363 [00:54<00:04, 1575.72it/s] 77%|███████▋  | 24768/32363 [00:54<00:04, 1627.18it/s] 77%|███████▋  | 24931/32363 [00:54<00:04, 1583.09it/s] 78%|███████▊  | 25100/32363 [00:54<00:04, 1614.29it/s] 78%|███████▊  | 25264/32363 [00:54<00:04, 1621.78it/s] 79%|███████▊  | 25427/32363 [00:54<00:04, 1589.67it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (18600, 34368), ratio: 0.5412011173317853 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (46693396, 140684736), ratio: 0.33190093913244906 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2188233, 3093120.0), ratio: 0.7074516992552156 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17317763028, 49542874560.0), ratio: 0.34955103396406556 
 79%|███████▉  | 25593/32363 [00:54<00:04, 1610.01it/s] 80%|███████▉  | 25761/32363 [00:54<00:04, 1594.97it/s] 80%|████████  | 25937/32363 [00:54<00:03, 1610.62it/s] 81%|████████  | 26113/32363 [00:54<00:03, 1635.35it/s] 81%|████████  | 26289/32363 [00:55<00:03, 1646.78it/s] 82%|████████▏ | 26465/32363 [00:55<00:03, 1657.85it/s] 82%|████████▏ | 26641/32363 [00:55<00:03, 1664.67it/s] 83%|████████▎ | 26817/32363 [00:55<00:03, 1670.05it/s] 83%|████████▎ | 26993/32363 [00:55<00:03, 1676.95it/s] 84%|████████▍ | 27169/32363 [00:55<00:03, 1684.21it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (18429, 32256), ratio: 0.57133556548948 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (48555270, 144016512), ratio: 0.33715071505134536 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (2010324, 2725632.0), ratio: 0.7375625176106909 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17528559113, 49833705792.0), ratio: 0.351741032187374 
 84%|████████▍ | 27345/32363 [00:55<00:02, 1694.38it/s] 85%|████████▌ | 27521/32363 [00:55<00:02, 1702.42it/s] 86%|████████▌ | 27697/32363 [00:55<00:02, 1711.28it/s] 86%|████████▌ | 27873/32363 [00:55<00:02, 1718.15it/s] 87%|████████▋ | 28049/32363 [00:56<00:02, 1726.76it/s] 87%|████████▋ | 28225/32363 [00:56<00:02, 1734.77it/s] 88%|████████▊ | 28402/32363 [00:56<00:02, 1745.22it/s] 88%|████████▊ | 28578/32363 [00:56<00:02, 1749.53it/s] 89%|████████▉ | 28759/32363 [00:56<00:02, 1767.44it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (17661, 29376), ratio: 0.6012050653730526 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (50364468, 147109440), ratio: 0.3423605446394239 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (1743918, 2261952.0), ratio: 0.770979225023444 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17717588909, 50084543232.0), ratio: 0.3537536286779967 
 89%|████████▉ | 28940/32363 [00:56<00:01, 1779.92it/s] 90%|████████▉ | 29121/32363 [00:56<00:01, 1749.74it/s] 91%|█████████ | 29307/32363 [00:56<00:01, 1782.06it/s] 91%|█████████ | 29489/32363 [00:56<00:01, 1754.84it/s] 92%|█████████▏| 29670/32363 [00:56<00:01, 1770.83it/s] 92%|█████████▏| 29848/32363 [00:57<00:01, 1758.25it/s] 93%|█████████▎| 30033/32363 [00:57<00:01, 1763.70it/s] 93%|█████████▎| 30232/32363 [00:57<00:01, 1829.93it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (4608, 4608), ratio: 1.0 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (51668209, 149089920), ratio: 0.3465573594780965 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (57600, 57600.0), ratio: 1.0 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17823279265, 50216748864.0), ratio: 0.35492698488446695 
 94%|█████████▍| 30433/32363 [00:57<00:01, 1854.84it/s] 95%|█████████▍| 30641/32363 [00:57<00:00, 1899.79it/s] 95%|█████████▌| 30849/32363 [00:57<00:00, 1928.41it/s] 96%|█████████▌| 31057/32363 [00:57<00:00, 1938.69it/s] 97%|█████████▋| 31265/32363 [00:57<00:00, 1953.59it/s] 97%|█████████▋| 31473/32363 [00:57<00:00, 1965.24it/s] 98%|█████████▊| 31681/32363 [00:58<00:00, 1972.40it/s] 99%|█████████▊| 31889/32363 [00:58<00:00, 1978.68it/s]
###############################trnMask.kept_tokens_count_seq#####################################
trnMask.kept_tokens_count_seq (kept, total) : (3456, 3456), ratio: 1.0 

###############################trnMask.kept_tokens_count_total for now#####################################
trnMask.kept_tokens_count_total (kept, total) : (52064857, 149486976), ratio: 0.3482902550654356 

###############################trnMask.kept_attmap_count_seq#####################################
trnMask.kept_attmap_count_seq (kept, total) : (32832, 32832.0), ratio: 1.0 

###############################trnMask.kept_attmap_count_total for now#####################################
trnMask.kept_attmap_count_total (kept, total) : (17827614985, 50221084992.0), ratio: 0.3549826728721584 
 99%|█████████▉| 32097/32363 [00:58<00:00, 1984.00it/s]100%|█████████▉| 32296/32363 [00:58<00:00, 1959.35it/s]100%|██████████| 32363/32363 [00:58<00:00, 554.31it/s] 
2025-01-03:15:09:53,632 INFO     [evaluator.py:319] Running loglikelihood_rolling requests

#################in loglikelihood_rolling#####################
  0%|          | 0/62 [00:00<?, ?it/s]  5%|▍         | 3/62 [00:00<00:02, 22.38it/s] 10%|▉         | 6/62 [00:00<00:03, 18.28it/s] 13%|█▎        | 8/62 [00:00<00:03, 14.73it/s] 16%|█▌        | 10/62 [00:00<00:03, 13.26it/s] 19%|█▉        | 12/62 [00:00<00:03, 12.51it/s] 27%|██▋       | 17/62 [00:01<00:02, 17.71it/s] 32%|███▏      | 20/62 [00:01<00:02, 18.45it/s] 37%|███▋      | 23/62 [00:01<00:02, 18.80it/s] 40%|████      | 25/62 [00:01<00:02, 15.69it/s] 44%|████▎     | 27/62 [00:01<00:02, 13.17it/s] 52%|█████▏    | 32/62 [00:01<00:01, 19.39it/s] 56%|█████▋    | 35/62 [00:02<00:01, 17.08it/s] 60%|█████▉    | 37/62 [00:02<00:01, 17.20it/s] 63%|██████▎   | 39/62 [00:02<00:01, 13.55it/s] 66%|██████▌   | 41/62 [00:02<00:01, 11.23it/s] 71%|███████   | 44/62 [00:02<00:01, 13.67it/s] 77%|███████▋  | 48/62 [00:03<00:00, 16.52it/s] 84%|████████▍ | 52/62 [00:03<00:00, 19.78it/s] 92%|█████████▏| 57/62 [00:03<00:00, 23.95it/s] 97%|█████████▋| 60/62 [00:03<00:00, 23.08it/s]100%|██████████| 62/62 [00:03<00:00, 17.33it/s]#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################
#################in _loglikelihood_tokens#####################

bootstrapping for stddev: perplexity
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:54,  1.82it/s] 33%|███▎      | 33/100 [00:00<00:01, 47.51it/s] 40%|████      | 40/100 [00:01<00:01, 41.04it/s] 65%|██████▌   | 65/100 [00:01<00:00, 68.03it/s] 74%|███████▍  | 74/100 [00:01<00:00, 57.92it/s] 82%|████████▏ | 82/100 [00:01<00:00, 57.25it/s] 98%|█████████▊| 98/100 [00:01<00:00, 67.98it/s]100%|██████████| 100/100 [00:01<00:00, 54.81it/s]fatal: not a git repository (or any parent up to mount point /lustre)
Stopping at filesystem boundary (GIT_DISCOVERY_ACROSS_FILESYSTEM not set).

hf (pretrained=/lustre/fast/fast/txiao/shihan/saves/gpt-neox-new_seg/pythia160m-deduped/scaled_masked_softmax_fusion/checkpoints_w64_h2048/hf_checkpoints/global_step143000), gen_kwargs: (), limit: None, num_fewshot: 5, batch_size: 16
|    Tasks     |Version|Filter|n-shot|    Metric     | Value |   |Stderr|
|--------------|-------|------|-----:|---------------|------:|---|-----:|
|arc_challenge |Yaml   |none  |     5|acc            | 0.2065|±  |0.0118|
|              |       |none  |     5|acc_norm       | 0.2432|±  |0.0125|
|arc_easy      |Yaml   |none  |     5|acc            | 0.4853|±  |0.0103|
|              |       |none  |     5|acc_norm       | 0.4508|±  |0.0102|
|lambada_openai|Yaml   |none  |     5|perplexity     |36.4887|±  |1.2458|
|              |       |none  |     5|acc            | 0.3053|±  |0.0064|
|logiqa        |Yaml   |none  |     5|acc            | 0.2657|±  |0.0173|
|              |       |none  |     5|acc_norm       | 0.2688|±  |0.0174|
|piqa          |Yaml   |none  |     5|acc            | 0.6415|±  |0.0112|
|              |       |none  |     5|acc_norm       | 0.6404|±  |0.0112|
|sciq          |Yaml   |none  |     5|acc            | 0.8030|±  |0.0126|
|              |       |none  |     5|acc_norm       | 0.7870|±  |0.0130|
|wikitext      |Yaml   |none  |     5|word_perplexity|30.4669|   |      |
|              |       |none  |     5|byte_perplexity| 1.8945|   |      |
|              |       |none  |     5|bits_per_byte  | 0.9218|   |      |
|winogrande    |Yaml   |none  |     5|acc            | 0.5170|±  |0.0140|
|wsc           |Yaml   |none  |     5|acc            | 0.3942|±  |0.0482|

